"use strict";(self.webpackChunkchunjun_web=self.webpackChunkchunjun_web||[]).push([[7587],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return d}});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var u=r.createContext({}),c=function(e){var n=r.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},p=function(e){var n=c(e.components);return r.createElement(u.Provider,{value:n},e.children)},s={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,u=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),m=c(t),d=a,f=m["".concat(u,".").concat(d)]||m[d]||s[d]||o;return t?r.createElement(f,l(l({ref:n},p),{},{components:t})):r.createElement(f,l({ref:n},p))}));function d(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,l=new Array(o);l[0]=m;var i={};for(var u in n)hasOwnProperty.call(n,u)&&(i[u]=n[u]);i.originalType=e,i.mdxType="string"==typeof e?e:a,l[1]=i;for(var c=2;c<o;c++)l[c]=t[c];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},3475:function(e,n,t){t.r(n),t.d(n,{assets:function(){return p},contentTitle:function(){return u},default:function(){return d},frontMatter:function(){return i},metadata:function(){return c},toc:function(){return s}});var r=t(7462),a=t(3366),o=(t(7294),t(3905)),l=["components"],i={},u="\u4ec0\u4e48\u662f\u589e\u91cf\u540c\u6b65",c={unversionedId:"chunjunDocs/incremental",id:"chunjunDocs/incremental",title:"\u4ec0\u4e48\u662f\u589e\u91cf\u540c\u6b65",description:"\u200b\t\u589e\u91cf\u540c\u6b65\u4e3b\u8981\u9488\u5bf9\u67d0\u4e9b\u53ea\u6709Insert\u64cd\u4f5c\u7684\u8868\uff0c\u968f\u7740\u4e1a\u52a1\u589e\u957f\uff0c\u8868\u5185\u6570\u636e\u8d8a\u6765\u8d8a\u591a\u3002\u5982\u679c\u6bcf\u6b21\u90fd\u540c\u6b65\u6574\u8868\u7684\u8bdd\uff0c\u6d88\u8017\u7684\u65f6\u95f4\u548c\u8d44\u6e90\u4f1a\u6bd4\u8f83\u591a\u3002\u56e0\u6b64\u9700\u8981\u4e00\u4e2a\u589e\u91cf\u540c\u6b65\u7684\u529f\u80fd\uff0c\u6bcf\u6b21\u53ea\u8bfb\u53d6\u589e\u52a0\u90e8\u5206\u7684\u6570\u636e\u3002",source:"@site/i18n/zh-cn/docusaurus-plugin-content-docs/current/chunjunDocs/incremental.md",sourceDirName:"chunjunDocs",slug:"/chunjunDocs/incremental",permalink:"/chunjun-web/docs/chunjunDocs/incremental",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/chunjunDocs/incremental.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"ChunJun \u901a\u7528\u914d\u7f6e\u8be6\u89e3",permalink:"/chunjun-web/docs/chunjunDocs/general-configuration"},next:{title:"\u65ad\u70b9\u7eed\u4f20\u4ecb\u7ecd",permalink:"/chunjun-web/docs/chunjunDocs/restore"}},p={},s=[{value:"\u539f\u7406\u89e3\u6790",id:"\u539f\u7406\u89e3\u6790",level:2},{value:"\u4f7f\u7528\u9650\u5236",id:"\u4f7f\u7528\u9650\u5236",level:2},{value:"\u5982\u4f55\u5904\u7406\u589e\u91cf\u952e\u91cd\u590d\u573a\u666f",id:"\u5982\u4f55\u5904\u7406\u589e\u91cf\u952e\u91cd\u590d\u573a\u666f",level:2},{value:"\u73af\u5883\u51c6\u5907",id:"\u73af\u5883\u51c6\u5907",level:2},{value:"\u811a\u672c\u914d\u7f6e",id:"\u811a\u672c\u914d\u7f6e",level:2},{value:"\u67e5\u8be2prometheus",id:"\u67e5\u8be2prometheus",level:2}],m={toc:s};function d(e){var n=e.components,i=(0,a.Z)(e,l);return(0,o.kt)("wrapper",(0,r.Z)({},m,i,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"\u4ec0\u4e48\u662f\u589e\u91cf\u540c\u6b65"},"\u4ec0\u4e48\u662f\u589e\u91cf\u540c\u6b65"),(0,o.kt)("p",null,"\u200b\t\u589e\u91cf\u540c\u6b65\u4e3b\u8981\u9488\u5bf9\u67d0\u4e9b\u53ea\u6709Insert\u64cd\u4f5c\u7684\u8868\uff0c\u968f\u7740\u4e1a\u52a1\u589e\u957f\uff0c\u8868\u5185\u6570\u636e\u8d8a\u6765\u8d8a\u591a\u3002\u5982\u679c\u6bcf\u6b21\u90fd\u540c\u6b65\u6574\u8868\u7684\u8bdd\uff0c\u6d88\u8017\u7684\u65f6\u95f4\u548c\u8d44\u6e90\u4f1a\u6bd4\u8f83\u591a\u3002\u56e0\u6b64\u9700\u8981\u4e00\u4e2a\u589e\u91cf\u540c\u6b65\u7684\u529f\u80fd\uff0c\u6bcf\u6b21\u53ea\u8bfb\u53d6\u589e\u52a0\u90e8\u5206\u7684\u6570\u636e\u3002"),(0,o.kt)("h2",{id:"\u539f\u7406\u89e3\u6790"},"\u539f\u7406\u89e3\u6790"),(0,o.kt)("p",null,"\u200b\t\u5176\u5b9e\u73b0\u539f\u7406\u5b9e\u9645\u4e0a\u5c31\u662f\u914d\u5408\u589e\u91cf\u952e\u5728\u67e5\u8be2\u7684sql\u8bed\u53e5\u4e2d\u62fc\u63a5\u8fc7\u6ee4\u6761\u4ef6\uff0c\u6bd4\u5982 where id > ? \uff0c\u5c06\u4e4b\u524d\u5df2\u7ecf\u8bfb\u53d6\u8fc7\u7684\u6570\u636e\u8fc7\u6ee4\u51fa\u53bb\u3002"),(0,o.kt)("p",null,"\u200b\t\u589e\u91cf\u540c\u6b65\u662f\u9488\u5bf9\u4e8e\u4e24\u4e2a\u53ca\u4ee5\u4e0a\u7684\u540c\u6b65\u4f5c\u4e1a\u6765\u8bf4\u7684\u3002\u5bf9\u4e8e\u521d\u6b21\u6267\u884c\u589e\u91cf\u540c\u6b65\u7684\u4f5c\u4e1a\u800c\u8a00\uff0c\u5b9e\u9645\u4e0a\u662f\u6574\u8868\u540c\u6b65\uff0c\u4e0d\u540c\u4e8e\u5176\u4ed6\u4f5c\u4e1a\u7684\u5728\u4e8e\u589e\u91cf\u540c\u6b65\u4f5c\u4e1a\u4f1a\u5728\u4f5c\u4e1a\u6267\u884c\u5b8c\u6210\u540e\u8bb0\u5f55\u4e00\u4e2aendLocation\u6307\u6807\uff0c\u5e76\u5c06\u8fd9\u4e2a\u6307\u6807\u4e0a\u4f20\u5230prometheus\u4ee5\u4f9b\u540e\u7eed\u4f7f\u7528\u3002\u9664\u7b2c\u4e00\u6b21\u4f5c\u4e1a\u5916\uff0c\u540e\u7eed\u7684\u6240\u6709\u589e\u91cf\u540c\u6b65\u4f5c\u4e1a\u90fd\u4f1a\u53d6\u4e0a\u4e00\u6b21\u4f5c\u4e1a\u7684endLocation\u505a\u4e3a\u672c\u6b21\u4f5c\u4e1a\u7684\u8fc7\u6ee4\u4f9d\u636e\uff08startLocation\uff09\u3002\u6bd4\u5982\u7b2c\u4e00\u6b21\u4f5c\u4e1a\u6267\u884c\u5b8c\u540e\uff0cendLocation\u4e3a10\uff0c\u90a3\u4e48\u4e0b\u4e00\u4e2a\u4f5c\u4e1a\u5c31\u4f1a\u6784\u5efa\u51fa\u4f8b\u5982 SELECT id,name,age from table where id > 10\u7684SQL\u8bed\u53e5\uff0c\u8fbe\u5230\u589e\u91cf\u8bfb\u53d6\u7684\u76ee\u7684\u3002"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u589e\u91cf\u952e\uff1a\u6570\u636e\u5e93\u8868\u4e2d\u589e\u91cf\u9012\u589e\u7684\u5b57\u6bb5\uff0c\u6bd4\u5982\u81ea\u589eid")),(0,o.kt)("h2",{id:"\u4f7f\u7528\u9650\u5236"},"\u4f7f\u7528\u9650\u5236"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u53ea\u6709RDB\u7684Reader\u63d2\u4ef6\u63d2\u4ef6\u53ef\u4ee5\u4f7f\u7528",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"\u901a\u8fc7\u6784\u5efaSQL\u8fc7\u6ee4\u8bed\u53e5\u5b9e\u73b0\uff0c\u56e0\u6b64\u53ea\u80fd\u7528\u4e8eRDB\u63d2\u4ef6"),(0,o.kt)("li",{parentName:"ul"},"\u589e\u91cf\u540c\u6b65\u53ea\u5173\u5fc3\u8bfb\uff0c\u4e0d\u5173\u5fc3\u5199\uff0c\u56e0\u6b64\u53ea\u4e0ereader\u63d2\u4ef6\u6709\u5173"))),(0,o.kt)("li",{parentName:"ul"},"\u589e\u91cf\u5b57\u6bb5\u53ea\u80fd\u4e3a\u6570\u503c\u7c7b\u578b\u548c\u65f6\u95f4\u7c7b\u578b",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"\u6307\u6807\u9700\u8981\u4e0a\u4f20\u5230prometheus\uff0c\u800cprometheus\u4e0d\u652f\u6301\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c\u56e0\u6b64\u53ea\u652f\u6301\u6570\u636e\u7c7b\u578b\u548c\u65f6\u95f4\u7c7b\u578b\u3002\u65f6\u95f4\u7c7b\u578b\u4f1a\u8f6c\u6362\u6210\u65f6\u95f4\u6233\u540e\u4e0a\u4f20"))),(0,o.kt)("li",{parentName:"ul"},"\u589e\u91cf\u952e\u7684\u503c\u53ef\u4ee5\u91cd\u590d\uff0c\u4f46\u5fc5\u987b\u9012\u589e",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"\u7531\u4e8e\u4f7f\u7528'>'\u7684\u7f18\u6545\uff0c\u8981\u6c42\u5b57\u6bb5\u5fc5\u987b\u9012\u589e\u3002")))),(0,o.kt)("h2",{id:"\u5982\u4f55\u5904\u7406\u589e\u91cf\u952e\u91cd\u590d\u573a\u666f"},"\u5982\u4f55\u5904\u7406\u589e\u91cf\u952e\u91cd\u590d\u573a\u666f"),(0,o.kt)("p",null,"\u200b\t\u8003\u8651\u53ef\u80fd\u5b58\u5728\u8fd9\u6837\u7684\u573a\u666f\uff1a\u67d0\u4e00\u6b21\u589e\u91cf\u540c\u6b65\u540e\u7684endLocation\u4e3ax\uff0c\u5728\u4e0b\u4e00\u6b21\u589e\u91cf\u540c\u6b65\u4f5c\u4e1a\u542f\u52a8\u7684\u95f4\u9699\u4e2d\uff0c\u8868\u5185\u53c8\u5199\u5165\u4e86\u589e\u91cf\u952e\u7684\u503c=x\u7684\u6570\u636e\u3002\u6309\u7167\u9ed8\u8ba4\u7684\u60c5\u51b5\uff0c\u5047\u8bbe\u589e\u91cf\u952e\u4e3aid\uff0c\u4e0b\u4e00\u6b21\u4f5c\u4e1a\u4f1a\u62fc\u63a5\u4f8b\u5982SELECT id,name,age FROM table WHERE id > x\u3002\u6b64\u65f6\u5728\u95f4\u9699\u4e2d\u63d2\u5165\u7684id=x\u7684\u6570\u636e\u5c06\u4f1a\u4e22\u5931\u3002"),(0,o.kt)("p",null,"\u200b\t\u4e3a\u4e86\u5bf9\u5e94\u4e0a\u8ff0\u573a\u666f\uff0cchunjun\u589e\u91cf\u540c\u6b65\u63d0\u4f9b\u4e86\u914d\u7f6e\u9879useMaxFunc\uff08\u9ed8\u8ba4\u503c\u4e3afalse\uff09\u3002\u5728\u8bbe\u7f6euseMaxFunc=true\u65f6\uff0cchunjun\u4f1a\u5728\u589e\u91cf\u4f5c\u4e1a\u542f\u52a8\u65f6\u83b7\u53d6\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u589e\u91cf\u952e\u7684\u6700\u5927\u503c\u4f5c\u4e3a\u672c\u6b21\u4f5c\u4e1a\u7684endLocation\uff0c\u5e76\u4e14\u5c06\u7528\u4e8estartLocation\u7684\u8fd0\u7b97\u7b26\u53f7\u4ece'>'\u6539\u4e3a'>='\u3002\u4f8b\u5982\uff1a"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u67d0\u4e00\u6b21\u589e\u91cf\u542f\u52a8\u65f6\u4e0a\u6b21\u4f5c\u4e1a\u7684endLocation\u4e3a10\uff0cid\u6700\u5927\u503c\u4e3a100\uff0c\u90a3\u4e48\u5c06\u4f1a\u62fc\u63a5SQL\u8bed\u53e5 SELECT id,name,age FROM table WHERE id >= 10 AND id < 100"),(0,o.kt)("li",{parentName:"ul"},"\u4e0b\u4e00\u6b21\u589e\u91cf\u4f5c\u4e1a\u542f\u52a8\u65f6id\u7684\u6700\u5927\u503c\u4e3a200\uff0c\u90a3\u4e48\u5c06\u4f1a\u62fc\u63a5SQL\u8bed\u53e5 SELECT id,name,age FROM table WHERE id >=100 AND id < 200")),(0,o.kt)("h1",{id:"\u5982\u4f55\u4f7f\u7528\u589e\u91cf\u540c\u6b65"},"\u5982\u4f55\u4f7f\u7528\u589e\u91cf\u540c\u6b65"),(0,o.kt)("h2",{id:"\u73af\u5883\u51c6\u5907"},"\u73af\u5883\u51c6\u5907"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u7531\u4e8e\u662f\u4f7f\u7528prometheus\u6536\u96c6\u76f8\u5173\u6307\u6807\u4fe1\u606f\uff0c\u56e0\u6b64\u9700\u8981\u5148\u5b89\u88c5prometheus\u548cpushgateway\u3002")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u4e0b\u8f7dFlink Metric Prometheus\u4f9d\u8d56\uff0c\u5c06\u5176\u653e\u5165Flink lib\u76ee\u5f55\u4e0b"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://repo1.maven.org/maven2/org/apache/flink/flink-metrics-prometheus_2.12/1.12.7/flink-metrics-prometheus_2.12-1.12.7.jar"},"https://repo1.maven.org/maven2/org/apache/flink/flink-metrics-prometheus_2.12/1.12.7/flink-metrics-prometheus_2.12-1.12.7.jar")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u4fee\u6539Flink\u914d\u7f6e\u6587\u4ef6\uff0cconf/flink-conf.yaml\uff0c\u65b0\u589eflink metric\u76f8\u5173\u914d\u7f6e"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"metrics.reporter.promgateway.host: host01\nmetrics.reporter.promgateway.port: 9091\nmetrics.reporter.promgateway.deleteOnShutdown: false\nmetrics.reporter.promgateway.class: org.apache.flink.metrics.prometheus.PrometheusPushGatewayReporter\n")))),(0,o.kt)("h2",{id:"\u811a\u672c\u914d\u7f6e"},"\u811a\u672c\u914d\u7f6e"),(0,o.kt)("p",null,"\u4e3b\u8981\u7684\u914d\u7f6e\u9879\u5c31\u662fincreColumn\u548cstartLocation"),(0,o.kt)("p",null,"\u4ee5mysql\u4e3a\u4f8b\u811a\u672c\u5982\u4e0b\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "job": {\n    "content": [\n      {\n        "reader": {\n          "name": "mysqlreader",\n          "parameter": {\n            "column": [\n              {\n                "name": "id",\n                "type": "int"\n              },\n              {\n                "name": "name",\n                "type": "string"\n              },\n              {\n                "name": "age",\n                "type": "int"\n              }\n            ],\n            "customSql": "",\n            "increColumn": "id",  //\u6307\u5b9a\u589e\u91cf\u5b57\u6bb5\u8fdb\u884c\u589e\u91cf\u540c\u6b65\uff0c\u589e\u91cf\u5b57\u6bb5\u5fc5\u987b\u662fcolumn\u5b58\u5728\u7684\u5b57\u6bb5\n            "startLocation": "2", //\u7b2c\u4e00\u6b21\u6267\u884c\u65f6\u4e3a\u7a7a\uff0c\u53ef\u914d\u7f6e\u5b57\u7b26\u4e32\u6216\u4e0d\u914d\u7f6e\uff0c\u540e\u7eed\u63d0\u4ea4\u7684\u4f5c\u4e1a\u4f7f\u7528prometheus\u4e2d\u6307\u6807\u503c\n            "username": "root",\n            "password": "root",\n            "connection": [\n              {\n                "jdbcUrl": [\n                  "jdbc:mysql://localhost:3306/test?useSSL=false"\n                ],\n                "table": [\n                  "baserow"\n                ]\n              }\n            ]\n          }\n        },\n        "writer": {\n          "name": "streamwriter",\n          "parameter": {\n            "print": false\n          }\n        }\n      }\n    ],\n    "setting": {\n      "restore": {\n        "restoreColumnName": "id"\n      },\n      "speed": {\n        "channel": 1,\n        "bytes": 0\n      }\n    }\n  }\n}\n\n')),(0,o.kt)("h2",{id:"\u67e5\u8be2prometheus"},"\u67e5\u8be2prometheus"),(0,o.kt)("p",null,"\u4f7f\u7528flink\u4f5c\u4e1a\u5bf9\u5e94\u7684JobId\u5728\u666e\u7f57\u7c73\u4fee\u65af\u4e2d\u67e5\u8be2endLocation\u6307\u6807\u503c"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'flink_taskmanager_job_task_operator_flinkx_endlocation{job_id="xxx"}\n')),(0,o.kt)("p",null,(0,o.kt)("img",{loading:"lazy",alt:"image-20220508231718458",src:t(2928).Z,width:"3154",height:"1790"})))}d.isMDXComponent=!0},2928:function(e,n,t){n.Z=t.p+"assets/images/prometheus-search-3fd9110d681059a8eee0540f189cff34.png"}}]);