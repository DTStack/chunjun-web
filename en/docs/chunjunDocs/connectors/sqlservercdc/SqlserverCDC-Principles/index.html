<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/chunjun-web/en/blog/rss.xml" title="ChunJun 纯钧 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/chunjun-web/en/blog/atom.xml" title="ChunJun 纯钧 Atom Feed"><title data-rh="true">SqlServer CDC  Principles | ChunJun 纯钧</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://dtstack.github.io/chunjun-web//chunjun-web/en/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-Principles"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="SqlServer CDC  Principles | ChunJun 纯钧"><meta data-rh="true" name="description" content="SqlServer official support for CDC from SqlServer 2008 version, the document link is as follows."><meta data-rh="true" property="og:description" content="SqlServer official support for CDC from SqlServer 2008 version, the document link is as follows."><link data-rh="true" rel="icon" href="/chunjun-web/en/img/logo-dark.svg"><link data-rh="true" rel="canonical" href="https://dtstack.github.io/chunjun-web//chunjun-web/en/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-Principles"><link data-rh="true" rel="alternate" href="https://dtstack.github.io/chunjun-web//chunjun-web/en/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-Principles" hreflang="en"><link data-rh="true" rel="alternate" href="https://dtstack.github.io/chunjun-web//chunjun-web/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-Principles" hreflang="中文"><link data-rh="true" rel="alternate" href="https://dtstack.github.io/chunjun-web//chunjun-web/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-Principles" hreflang="x-default"><link rel="stylesheet" href="/chunjun-web/en/assets/css/styles.89ec17d5.css">
<link rel="preload" href="/chunjun-web/en/assets/js/runtime~main.6edfbc16.js" as="script">
<link rel="preload" href="/chunjun-web/en/assets/js/main.610ed450.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/chunjun-web/en/"><div class="navbar__logo"><img src="/chunjun-web/en/img/logo-dark.svg" alt="ChunJun Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/chunjun-web/en/img/logo-dark.svg" alt="ChunJun Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">ChunJun 纯钧</b></a><a class="navbar__item navbar__link navbar__link--active" href="/chunjun-web/en/docs/chunjunDocs/intro">Docs</a><a class="navbar__item navbar__link" href="/chunjun-web/en/blog">Blog</a><a href="https://github.com/DTStack/chunjun/releases" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Download</a><a class="navbar__item navbar__link" href="/chunjun-web/en/docs/roadmap/intro">Roadmap</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/chunjun-web/en/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-Principles" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/chunjun-web/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-Principles" target="_self" rel="noopener noreferrer" class="dropdown__link">中文（中国）</a></li></ul></div><a href="https://github.com/DTStack/chunjun" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/dirty-plugins">脏数据插件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/quickstart">QuickStart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/restore">Restore</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/chunjun-web/en/docs/chunjunDocs/connectors/binlog/binlog-source">Connectors</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/binlog/binlog-source">Binlog Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/clickhouse/clickhouse-lookup">ClickHouse Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/db2/db2-lookup">DB2 Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/dm/dm-sink">DM Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/doris/dorisbatch-sink">Doris Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/elasticsearch/es7-lookup">ElasticSearch Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/gbase/gbase-lookup">GBase Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/greenplum/greenplum-sink">Greenplum Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/hbase/hbase-lookup">Hbase Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/hdfs/hdfs-sink">HDFS Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/hive/hive-lookup">Hive Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/influxdb/influxdb-sink">Influx Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/kafka/kafka-sink">Kafka Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/kingbase/kingbase-sink">KingBase Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/kudu/kudu-lookup">Kudu Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner-source">LogMiner Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/mongodb/mongodb-sink">MongoDB Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/mysql/mysql-lookup">MySQL Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/oracle/oracle-lookup">Oracle Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/pgwal/PostgresCDC-Source-en">PG-Wal CDC Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/postgresql/postgres-lookup">PostgreSQL Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/saphana/saphana-sink">Saphana Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/sqlserver/sqlserver-lookup">SQL Server Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-Principles">SqlServer CDC Connector</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-Principles">SqlServer CDC  Principles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-configuration">SqlServer Configuring CDC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-source">SqlserverCDC Source</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/contributing">Contributing to ChunJun</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/change-log">ChunJun 1.12 新特性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/contribute-pr">How to submit a good PR</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/docker">ChunJun Docker</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/chunjun-web/en/docs/chunjunDocs/formats/protobuf-x">formats</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/general-configuration">ChunJun generic configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/incremental">What is incremental mode</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/chunjun-web/en/">🏠</a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">Connectors</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">SqlServer CDC Connector</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/chunjun-web/en/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-Principles">SqlServer CDC  Principles</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>SqlServer CDC  Principles</h1><h1>I. Basics</h1><p>SqlServer official support for CDC from SqlServer 2008 version, the document link is as follows.
<a href="https://docs.microsoft.com/zh-cn/sql/relational-databases/track-changes/about-change-data-capture-sql-server?view=sql-server-ver15" target="_blank" rel="noopener noreferrer">about-change-data-capture-sql-server</a></p><h1>II. Configuration</h1><p>The configuration document link is as follows.
<a href="/chunjun-web/en/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-configuration">SqlServerConfigurationCDC</a></p><h1>Three, the principle</h1><h3 class="anchor anchorWithStickyNavbar_mojV" id="1-sql-server-agent">1. SQL Server Agent<a class="hash-link" href="#1-sql-server-agent" title="Direct link to heading">​</a></h3><p>SQL Server Agent agent service, a standard service of sql server, serves as an agent to perform all sql automation
tasks, as well as unattended tasks such as database transactional replication. This service is stopped in the default
installation, you need to start it manually or change it to automatic movement, otherwise the automation tasks of sql
will not be executed, also pay attention to the service startup account. Simply put, this service is started before the
capture process will process the transaction log and write entries to the CDC table.
<a href="https://docs.microsoft.com/zh-cn/sql/ssms/agent/sql-server-agent?view=sql-server-ver15" target="_blank" rel="noopener noreferrer">sql-server-agent</a></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="2-comparison-of-database-cdc-before-and-after-turning-it-on">2. Comparison of database CDC before and after turning it on<a class="hash-link" href="#2-comparison-of-database-cdc-before-and-after-turning-it-on" title="Direct link to heading">​</a></h3><p>Before turning on.</p><div align="center"><img src="static/img/SqlserverCDC/Sqlserver7.png"></div><br>After opening. EXEC sys.sp_cdc_enable_db;<div align="center"><img src="static/img/SqlserverCDC/Sqlserver8.png"></div><br><p>We first observe that a new <strong>systranschemas</strong> table has been added under dbo. The <strong>systranschemas</strong> table is used to
track architectural changes in projects published in transaction releases and snapshot releases.</p><table><thead><tr><th>Column Name</th><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td>tabid</td><td>int</td><td>Identifies the table item where the schema change occurred.</td></tr><tr><td>startlsn</td><td>binary</td><td>The LSN value at the start of the schema change.</td></tr><tr><td>endlsn</td><td>binary</td><td>The LSN value at the end of the schema change.</td></tr><tr><td>typeid</td><td>int</td><td>The type of architecture change.</td></tr></tbody></table><p>A new schema named cdc has been added under the database, and in fact a new cdc user has been added. cdc has the
following four new tables.</p><br>**1. captured_columns** Returns a row for each column tracked in the captured instance. By default, all columns in the source table will be captured. However, if the source table is enabled for change data capture, columns can be included in or excluded from the capture by specifying a list of columns. When there is no business table with CDC enabled, the table is empty.<table><thead><tr><th>Column Name</th><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td>object_id</td><td>int</td><td>The ID of the change table to which the captured column belongs.</td></tr><tr><td>column_name</td><td>sysname</td><td>The name of the captured column.</td></tr><tr><td>column_id</td><td>int</td><td>The ID of the captured column in the source table.</td></tr><tr><td>column_type</td><td>sysname</td><td>The type of the captured column.</td></tr><tr><td>column_ordinal</td><td>int</td><td>Change the column ordinal number in the table (starting from 1). The metadata columns in the change table will be excluded. Serial number 1 will be assigned to the first column captured.</td></tr><tr><td>is_computed</td><td>bit</td><td>Indicates that the captured column is a computed column from the source table.</td></tr></tbody></table><p><strong>2. change_tables</strong>
Returns one row for each changed table in the database. When change data capture is enabled for a source table, a change
table is created. When no business table has CDC enabled, the table is empty.</p><table><thead><tr><th>Column Name</th><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td>object_id</td><td>int</td><td>The ID of the change table. Unique in the database.</td></tr><tr><td>version</td><td>int</td><td>Identified for reference only. Not supported. Future compatibility is not guaranteed. For SQL Server 2012 (11.x), this column always returns 0.</td></tr><tr><td>source_object_id</td><td>int</td><td>The ID of the source table enabled for change data capture.</td></tr><tr><td>capture_instance</td><td>sysname</td><td>The name of the capture instance used to name the instance-specific trace object. By default, the name is derived from the source schema name plus the source table name in the format schemaname_sourcename.</td></tr><tr><td>start_lsn</td><td>binary(10)</td><td>Log sequence number (LSN), indicating the low endpoint when querying the change data in the change table. null = low endpoint not yet established.</td></tr><tr><td>end_lsn</td><td>binary(10)</td><td>Identified for reference only. Not supported. Future compatibility is not guaranteed. For SQL Server 2008, this column always returns NULL.</td></tr><tr><td>supports_net_changes</td><td>bit</td><td>Enables query net change support for change tables.</td></tr><tr><td>has_drop_pending</td><td>bit</td><td>The capture process received a notification that the source table has been deleted.</td></tr><tr><td>role_name</td><td>sysname</td><td>The name of the database role used to access the changed data. nULL = role not used.</td></tr><tr><td>index_name</td><td>sysname</td><td>The name of the index used to uniquely identify the rows in the source table. index_name is the name of the primary key index of the source table, or the name of the unique index specified when change data capture was enabled for the source table. NULL = The source table had no primary key and no unique index was specified when change data capture was enabled. Note: If change data capture is enabled for a table with a primary key, the Change Data Capture feature will use the index regardless of whether net changes are enabled. When change data capture is enabled, changes to the primary key will not be allowed. If the table does not have a primary key, change data capture can still be enabled, but only net changes can be set to False. Once change data capture is enabled, primary keys can be created. Since the change data capture feature does not use primary keys, you can also modify primary keys.</td></tr><tr><td>filegroup_name</td><td>sysname</td><td>Changes the name of the filegroup in which the table resides. NULL = Changes the default filegroup in which the table resides in the database.</td></tr><tr><td>create_date</td><td>datetime</td><td>The date on which the source table was enabled.</td></tr><tr><td>partition_switch</td><td>bit</td><td>Indicates whether the SWITCH PARTITION command of ALTER TABLE can be executed on a table with change data capture enabled. 0 indicates that partition switching is blocked. Unpartitioned tables always return 1.</td></tr></tbody></table><p><strong>3. ddl_history</strong>
Returns one row for each Data Definition Language (DDL) change made to a table with change data capture enabled. You can
use this table to determine when DDL changes occurred to the source table and what was changed. This table does not
contain any entries for the source table where no DDL changes occurred. This table is empty when there are no changes to
the table structure of any business table with CDC turned on.</p><table><thead><tr><th>Column Name</th><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td>source_object_id</td><td>int</td><td>The ID of the source table to which the DDL change was applied.</td></tr><tr><td>object_id</td><td>int</td><td>The ID of the changed table associated with the capture instance of the source table.</td></tr><tr><td>required_column_update</td><td>bit</td><td>Indicates that the data type of the capture column was modified in the source table. This modification changes the columns in the change table.</td></tr><tr><td>ddl_command</td><td>nvarchar(max)</td><td>The DDL statement to be applied to the source table.</td></tr><tr><td>ddl_lsn</td><td>binary(10)</td><td>The log sequence number (LSN) associated with the commit of the DDL modification.</td></tr><tr><td>ddl_time</td><td>datetime</td><td>The date and time of the DDL changes made to the source table.</td></tr></tbody></table><p><strong>4. index_columns</strong>
Returns one row for each index column associated with the changed table. Change data capture uses these index columns to
uniquely identify the rows in the source table. By default, the primary key columns of the source table will be
included. However, if the source table&#x27;s unique index is specified when change data capture is enabled for the source
table, the columns in that index will be used instead. If net change tracking is enabled, the primary key or unique
index is required for that source table. When no index column exists for any business table with CDC enabled, the table
is empty.</p><table><thead><tr><th>Column Name</th><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td>object_id</td><td>int</td><td>Change the ID of the table.</td></tr><tr><td>column_name</td><td>sysname</td><td>The name of the index column.</td></tr><tr><td>index_ordinal</td><td>tinyint</td><td>The number of the column in the index (starting from 1).</td></tr><tr><td>column_id</td><td>int</td><td>The ID of the column in the source table.</td></tr></tbody></table><p><strong>5. lsn_time_mapping</strong>
Returns a row for each transaction that has a row in the change table. This table is used to create a mapping between
the log sequence number (LSN) commit value and the time of the committed transaction. Items that do not have
corresponding change table entries can also be logged so that the table records the completion of LSN processing during
periods of little or no change activity.</p><table><thead><tr><th>Column Name</th><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td>start_lsn</td><td>binary(10)</td><td>The LSN of the committed transaction.</td></tr><tr><td>tran_begin_time</td><td>datetime</td><td>The time when the transaction associated with the LSN started.</td></tr><tr><td>tran_end_time</td><td>datetime</td><td>The time when the transaction ended.</td></tr><tr><td>tran_id</td><td>varbinary (10)</td><td>The ID of the transaction.</td></tr></tbody></table><p>The following functions have been added under cdc.</p><br><p><strong>1. fn<em>cdc_get_all_changes</em></strong>
Returns one row for each change applied to the source table within the specified log sequence number (LSN) range. If the
source row has multiple changes within that interval, each change is represented in the returned result set. In addition
to returning change data, the four metadata columns provide the information needed to apply changes to another data
source. The row filter option controls the content of the metadata columns and the rows returned in the result set. When
the &quot;all&quot; row filter option is specified, there will be only one row for each change to identify that change. When the &quot;
all update old&quot; option is specified, the update operation is represented as two rows: one containing the values of the
captured columns before the update and the other containing the values of the captured columns after the update. This
enumerated function is created when change data capture is enabled for the source table. The function name is derived
and uses the <strong>cdc.fn<em>cdc_get_all_changes</em></strong><em>capture_instance</em> format, where <em>capture_instance</em> is the value specified
for the capture instance when change data capture is enabled for the source table.</p><table><thead><tr><th>column_name</th><th>data_type</th><th>description</th></tr></thead><tbody><tr><td>__$start_lsn</td><td>binary(10)</td><td>The commit LSN associated with the change, used to preserve the commit order of the change. Changes committed in the same transaction will share the same commit LSN value.</td></tr><tr><td>__$seqval</td><td>binary(10)</td><td>Sequence of values used to sort the row changes within a transaction.</td></tr><tr><td>__$operation</td><td>int</td><td>Identifies the Data Manipulation Language (DML) operation required to apply the changed data row to the target data source. Can be one of the following values.<br>1 = Delete<br>2 = Insert<br>3 = Update (the captured column value is the value before the update operation is performed). This value is applied only if the row filter option &quot;all update old&quot; is specified.<br>4 = update (the captured column value is the value after the update operation is performed).</td></tr><tr><td>__$update_mask</td><td>varbinary(128)</td><td>A bit mask that corresponds to one bit for each captured column that identifies the capture instance. When<!-- -->_<!-- -->_\$operation = 1 or 2, this value sets all defined bits to 1. When __$ operation = 3 or 4, only the bit corresponding to the changed column is set to 1.</td></tr><tr><td>\&lt;captured source table columns<!-- -->&gt;</td><td>various</td><td>The remaining columns returned by the function are the captured columns identified at the time the capture instance was created. If no columns are specified in the list of captured columns, all columns in the source table are returned.</td></tr></tbody></table><p><strong>2. fn<em>cdc_get_net_changes</em></strong>
Returns a net changes row for each source row within the specified log sequence number in the (LSN) range, in the same
format as above.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="3-comparison-of-before-and-after-business-table-cdc-is-turned-on">3. Comparison of before and after business table CDC is turned on<a class="hash-link" href="#3-comparison-of-before-and-after-business-table-cdc-is-turned-on" title="Direct link to heading">​</a></h3><p>Before opening is the same as the previous chart</p><p>Open SQL.</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">sys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sp_cdc_enable_table</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- the name of the schema to which the table belongs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@source_schema</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;source_schema&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- the name of the table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@source_name</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;source_name&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- is the name of the database role used to control access to the changed data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@role_name</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;role_name&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- is the name of the capture instance used to name the change data capture object, a name that will need to be used frequently in later stored procedures and functions.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@capture_instance</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;capture_instance&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- Indicates whether net change query support is enabled for this capture instance if this table has a primary key or a unique index that has been identified using the @index_name parameter. otherwise, this parameter defaults to 0.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@supports_net_changes</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> supports_net_changes </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- The name of the unique index used to uniquely identify the rows in the source table. index_name is sysname and can be NULL.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- If specified, index_name must be the only valid index of the source table. If index_name is specified, the index column identified takes precedence over any defined primary key column, just like the table&#x27;s unique row identifier.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@index_name</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;index_name&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- Which columns need to be captured. captured_column_list has the data type nvarchar(max) and can be NULL. if NULL, all columns will be included in the change table.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@captured_column_list</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;captured_column_list&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- is the filegroup to be used for the changes table created for the capture instance.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@filegroup_name</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;filegroup_name&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- Indicates whether the SWITCH PARTITION command of ALTER TABLE can be executed on tables with change data capture enabled.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- allow_partition_switch is bit, default value is 1.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@partition_switch</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;partition_switch&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>When turned on.</p><div align="center"><img src="static/img/SqlserverCDC/Sqlserver9.png"></div><br>At this point, a new table named dbo_kudu_CT is added under cdc, and for any business table with CDC turned on, a table of format $schema_$table_CT will be created under its corresponding cdc schema.<p><strong>1. dbo_kudu_CT:</strong>
The change table created when change data capture is enabled for the source table. This table returns one row for each
insert and delete operation performed on the source table and two rows for each update operation performed on the source
table. If the name of the change table is not specified when the source table is enabled, a derived name is used. The
format of the name is cdc. capture_instance _CT where capture_instance is the name of the source table&#x27;s schema and the
name of the source table in the format schema_table. For example, if change data capture is enabled for the table Person
in the AdventureWorks sample database, the derived change table name will be cdc.Person_Address_CT.</p><table><thead><tr><th>Column Name</th><th>Data Type</th><th>Description</th></tr></thead><tbody><tr><td>__$start_lsn</td><td>binary(10)</td><td>The log sequence number (LSN) associated with the commit transaction for the corresponding change. All changes committed in the same transaction will share the same commit LSN. For example, if a delete operation on a source table deletes two rows, the changes table will contain two rows, each with the same __ $ start_lsn value.</td></tr><tr><td>__ $ end_lsn</td><td>binary(10)</td><td>Marked as for information only. Not supported. Future compatibility is not guaranteed. In SQL Server 2012 (11.x), this column is always NULL.</td></tr><tr><td>__$seqval</td><td>binary(10)</td><td>Sequential value used to sort row changes within a transaction.</td></tr><tr><td>__$operation</td><td>int</td><td>Identifies the Data Manipulation Language (DML) operation associated with the corresponding change. Can be one of the following values.<br>1 = Delete<br>2 = Insert<br>3 = Update (old value) column data with the row value before the update statement was executed.<br>4 = Update (new value) column data with row values after the update statement is executed.</td></tr><tr><td>__$update_mask</td><td>varbinary(128)</td><td>Bitmask based on the column serial number of the change table, used to identify those columns that have changed.</td></tr><tr><td>\&lt;captured source table columns<!-- -->&gt;</td><td>Many and varied</td><td>The remaining columns in the change table are those that were identified as captured columns in the source table when the capture instance was created. If no columns are specified in the list of captured columns, all columns in the source table will be included in this table.</td></tr><tr><td>__ $ command_id</td><td>int</td><td>Tracks the order of operations in a transaction.</td></tr></tbody></table><p><strong>2. captured_columns:</strong></p><div align="center"><img src="static/img/SqlserverCDC/Sqlserver10.png"></div><br><p><strong>3. change_tables:</strong></p><div align="center"><img src="static/img/SqlserverCDC/Sqlserver11.png"></div><br><h3 class="anchor anchorWithStickyNavbar_mojV" id="4-acquisition-principle">4. Acquisition principle!<a class="hash-link" href="#4-acquisition-principle" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="1-insertdelete">1. insert/delete<a class="hash-link" href="#1-insertdelete" title="Direct link to heading">​</a></h4><p>For insert and delete type of data changes, for each row change will add a row in the corresponding
\${schema}<!-- -->_<!-- -->${table}<!-- -->_<!-- -->CT table. For insert, id, user_id, and name are the value values after insert; for delete, id,
user_id, and name are the value values before delete.</p><div align="center"><img src="static/img/SqlserverCDC/Sqlserver12.png"></div><br><h4 class="anchor anchorWithStickyNavbar_mojV" id="2-update">2. update<a class="hash-link" href="#2-update" title="Direct link to heading">​</a></h4><p>a. Primary key updated At this time, the SqlServer database practice is within the same thing, the original record is
deleted first, and then re-inserted. Execute the following SQL, log table as shown in the figure. UPDATE <!-- -->[dbo]<!-- -->. <!-- -->[kudu]<!-- -->
SET <!-- -->[id]<!-- --> = 2, <!-- -->[user_id]<!-- --> = &#x27;2&#x27;, <!-- -->[name]<!-- --> = &#x27;b&#x27; WHERE <!-- -->[id]<!-- --> = 1;</p><div align="center"><img src="static/img/SqlserverCDC/Sqlserver13.png"></div><br>b. Primary key not updated At this point, what the SqlServer database does is to update the field information directly. Execute the following SQL with the log table as shown in the figure. UPDATE [dbo]. [kudu] SET [user_id] = &#x27;3&#x27;, [name] = &#x27;c&#x27; WHERE [id] = 2;<div align="center"><img src="static/img/SqlserverCDC/Sqlserver14.png"></div><br><h4 class="anchor anchorWithStickyNavbar_mojV" id="3-flowchart">3. Flowchart<a class="hash-link" href="#3-flowchart" title="Direct link to heading">​</a></h4><div align="center"><img src="static/img/SqlserverCDC/Sqlserver15.png"></div><br>For FlinkX SqlServer CDC real-time collection plug-in, the basic principle is to call the fn_cdc_get_all_changes_ function in a polling manner, cyclically, to get the data between the last ending lsn and the current maximum lsn value of the database. For insert/delete types, it gets and parses one row, and for update types, it gets and parses two rows. After parsing, pass the data to the downstream and record the lsn of the current parsed data to prepare for the next polling.<h4 class="anchor anchorWithStickyNavbar_mojV" id="4-data-format">4. Data format<a class="hash-link" href="#4-data-format" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx json"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;update&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;schema&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;dbo&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;table&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tb1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;lsn&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;00000032:0000002038:0005&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;ts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6760525407742726144</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;before_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;after_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-Principles.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/chunjun-web/en/docs/chunjunDocs/connectors/sqlserver/sqlserver-source"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SqlServer Source</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/chunjun-web/en/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-configuration"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SqlServer Configuring CDC</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-sql-server-agent" class="table-of-contents__link toc-highlight">1. SQL Server Agent</a></li><li><a href="#2-comparison-of-database-cdc-before-and-after-turning-it-on" class="table-of-contents__link toc-highlight">2. Comparison of database CDC before and after turning it on</a></li><li><a href="#3-comparison-of-before-and-after-business-table-cdc-is-turned-on" class="table-of-contents__link toc-highlight">3. Comparison of before and after business table CDC is turned on</a></li><li><a href="#4-acquisition-principle" class="table-of-contents__link toc-highlight">4. Acquisition principle!</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/chunjun-web/en/docs/chunjunDocs/quickstart">快速上手</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/DTStack/chunjun/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Issue Tracker<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/DTStack/chunjun/pulls" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Pull Requests<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/DTStack/chunjun/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/chunjun-web/en/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/DTStack/chunjun" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 DTStack, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/chunjun-web/en/assets/js/runtime~main.6edfbc16.js"></script>
<script src="/chunjun-web/en/assets/js/main.610ed450.js"></script>
</body>
</html>