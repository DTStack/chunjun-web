"use strict";(self.webpackChunkchunjun_web=self.webpackChunkchunjun_web||[]).push([[9820],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return d}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var o=n.createContext({}),s=function(e){var t=n.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):u(u({},t),e)),a},p=function(e){var t=s(e.components);return n.createElement(o.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,o=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),c=s(a),d=r,k=c["".concat(o,".").concat(d)]||c[d]||m[d]||l;return a?n.createElement(k,u(u({ref:t},p),{},{components:a})):n.createElement(k,u({ref:t},p))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,u=new Array(l);u[0]=c;var i={};for(var o in t)hasOwnProperty.call(t,o)&&(i[o]=t[o]);i.originalType=e,i.mdxType="string"==typeof e?e:r,u[1]=i;for(var s=2;s<l;s++)u[s]=a[s];return n.createElement.apply(null,u)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},2503:function(e,t,a){a.r(t),a.d(t,{assets:function(){return p},contentTitle:function(){return o},default:function(){return d},frontMatter:function(){return i},metadata:function(){return s},toc:function(){return m}});var n=a(7462),r=a(3366),l=(a(7294),a(3905)),u=["components"],i={},o="SqlserverCDC Source",s={unversionedId:"chunjunDocs/connectors/sqlservercdc/SqlserverCDC-source",id:"chunjunDocs/connectors/sqlservercdc/SqlserverCDC-source",title:"SqlserverCDC Source",description:"1. Introduction",source:"@site/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-source.md",sourceDirName:"chunjunDocs/connectors/sqlservercdc",slug:"/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-source",permalink:"/chunjun-web/en/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-source",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-source.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"SqlServer Configuring CDC",permalink:"/chunjun-web/en/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-configuration"},next:{title:"Contributing to ChunJun",permalink:"/chunjun-web/en/docs/chunjunDocs/contributing"}},p={},m=[{value:"1. Introduction",id:"1-introduction",level:2},{value:"2. Supported Versions",id:"2-supported-versions",level:2},{value:"3. Database configuration",id:"3-database-configuration",level:2},{value:"4. SqlserverCDC Principle",id:"4-sqlservercdc-principle",level:2},{value:"5. Plugin Name",id:"5-plugin-name",level:2},{value:"6. Parameter Description",id:"6-parameter-description",level:2},{value:"6.1 Sync",id:"61-sync",level:3},{value:"6.2 SQL",id:"62-sql",level:3},{value:"7. Data Structure",id:"7-data-structure",level:2},{value:"8. data types",id:"8-data-types",level:2},{value:"9. Sample Scripts",id:"9-sample-scripts",level:2}],c={toc:m};function d(e){var t=e.components,a=(0,r.Z)(e,u);return(0,l.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"sqlservercdc-source"},"SqlserverCDC Source"),(0,l.kt)("h2",{id:"1-introduction"},"1. Introduction"),(0,l.kt)("p",null,"The Sqlservercdc plugin supports configuring the listener table name as well as reading the starting point to read log\ndata. SQLservercdc saves the currently consumed lsn at checkpoint, so the support runs continuously."),(0,l.kt)("h2",{id:"2-supported-versions"},"2. Supported Versions"),(0,l.kt)("p",null,"SqlServer 2012, 2014, 2016, 2017, 2019 standalone"),(0,l.kt)("h2",{id:"3-database-configuration"},"3. Database configuration"),(0,l.kt)("p",null,"[SqlserverCDC configuration]","(SqlserverCDC configuration.md)"),(0,l.kt)("h2",{id:"4-sqlservercdc-principle"},"4. SqlserverCDC Principle"),(0,l.kt)("p",null,"[SqlserverCDC Principle]","(SqlserverCDC Principle.md)"),(0,l.kt)("h2",{id:"5-plugin-name"},"5. Plugin Name"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Sync"),(0,l.kt)("th",{parentName:"tr",align:null},"sqlservercdcreader, sqlservercdcsource"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"SQL"),(0,l.kt)("td",{parentName:"tr",align:null},"sqlservercdc-x")))),(0,l.kt)("h2",{id:"6-parameter-description"},"6. Parameter Description"),(0,l.kt)("h3",{id:"61-sync"},"6.1 Sync"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"url"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Description: JDBC URL link for sqlserver database"),(0,l.kt)("li",{parentName:"ul"},"Required: yes"),(0,l.kt)("li",{parentName:"ul"},"Parameter type: string"),(0,l.kt)("li",{parentName:"ul"},"Default value: none")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"username"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Description: username"),(0,l.kt)("li",{parentName:"ul"},"Required: yes"),(0,l.kt)("li",{parentName:"ul"},"Parameter type: string"),(0,l.kt)("li",{parentName:"ul"},"Default value: none")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"password"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Description: Password"),(0,l.kt)("li",{parentName:"ul"},"Required: yes"),(0,l.kt)("li",{parentName:"ul"},"Parameter type: string"),(0,l.kt)("li",{parentName:"ul"},"Default value: none")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"tableList"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Description: The tables to listen to, e.g. ",'["schema1.table1", "schema1.table2"]',"."),(0,l.kt)("li",{parentName:"ul"},"Required: Yes"),(0,l.kt)("li",{parentName:"ul"},"Field type: array"),(0,l.kt)("li",{parentName:"ul"},"Default value: none")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"splitUpdate"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Description: When the data update type is update, whether to split the update into two pieces of data,\nsee ","[VI. Data Structure Description]","."),(0,l.kt)("li",{parentName:"ul"},"Required: No"),(0,l.kt)("li",{parentName:"ul"},"Field type: boolean"),(0,l.kt)("li",{parentName:"ul"},"Default value: false")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"cat"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Description: The type of operation to be listened to, UPDATE, INSERT, DELETE are available, case insensitive,\nmultiple, split by"),(0,l.kt)("li",{parentName:"ul"},"Required: No"),(0,l.kt)("li",{parentName:"ul"},"Field type: String"),(0,l.kt)("li",{parentName:"ul"},"Default value: UPDATE,INSERT,DELETE")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"lsn"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Description: The start position of the SqlServer CDC log sequence number to read"),(0,l.kt)("li",{parentName:"ul"},"Required: No"),(0,l.kt)("li",{parentName:"ul"},"Field Type: String(00000032:0000002038:0005)"),(0,l.kt)("li",{parentName:"ul"},"Default value: None")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"pollInterval"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Description: Listen to the interval of pulling SqlServer CDC database, the smaller the value, the smaller the\ncollection delay time, the more pressure on the database access"),(0,l.kt)("li",{parentName:"ul"},"Required: No"),(0,l.kt)("li",{parentName:"ul"},"Field type: long (in milliseconds)"),(0,l.kt)("li",{parentName:"ul"},"Default value: 1000")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"pavingData"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Description: Whether to paving the parsed json data, see ","[VII. Description of data structure]","."),(0,l.kt)("li",{parentName:"ul"},"Required: No"),(0,l.kt)("li",{parentName:"ul"},"Field type: boolean"),(0,l.kt)("li",{parentName:"ul"},"Default value: false")))),(0,l.kt)("h3",{id:"62-sql"},"6.2 SQL"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"url"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Description: JDBC URL link for sqlserver database"),(0,l.kt)("li",{parentName:"ul"},"Required: yes"),(0,l.kt)("li",{parentName:"ul"},"Parameter type: string"),(0,l.kt)("li",{parentName:"ul"},"Default value: none")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"username"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Description: username"),(0,l.kt)("li",{parentName:"ul"},"Required: yes"),(0,l.kt)("li",{parentName:"ul"},"Parameter type: string"),(0,l.kt)("li",{parentName:"ul"},"Default value: none")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"password"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Description: Password"),(0,l.kt)("li",{parentName:"ul"},"Required: yes"),(0,l.kt)("li",{parentName:"ul"},"Parameter type: string"),(0,l.kt)("li",{parentName:"ul"},"Default value: none")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"table"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Description: The data table to be parsed."),(0,l.kt)("li",{parentName:"ul"},"Note: SQL task only supports listening to a single table and the data format is schema.table"),(0,l.kt)("li",{parentName:"ul"},"Required: No"),(0,l.kt)("li",{parentName:"ul"},"Field type: string"),(0,l.kt)("li",{parentName:"ul"},"Default value: none")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"cat"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Description: The type of operation to be listened to, UPDATE, INSERT, DELETE, case insensitive, multiple, split by"),(0,l.kt)("li",{parentName:"ul"},"Required: No"),(0,l.kt)("li",{parentName:"ul"},"Field type: String"),(0,l.kt)("li",{parentName:"ul"},"Default value: UPDATE,INSERT,DELETE")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"lsn"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Description: The start position of the SqlServer CDC log sequence number to read"),(0,l.kt)("li",{parentName:"ul"},"Required: No"),(0,l.kt)("li",{parentName:"ul"},"Field Type: String(00000032:0000002038:0005)"),(0,l.kt)("li",{parentName:"ul"},"Default value: None")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"poll-interval"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Description: Listen to the interval of pulling SqlServer CDC database, the smaller the value, the smaller the\ncollection delay time, the more pressure on the database access"),(0,l.kt)("li",{parentName:"ul"},"Required: No"),(0,l.kt)("li",{parentName:"ul"},"Field type: long (in milliseconds)"),(0,l.kt)("li",{parentName:"ul"},"Default value: 1000")))),(0,l.kt)("h2",{id:"7-data-structure"},"7. Data Structure"),(0,l.kt)("p",null,"On 2020-01-01 12:30:00 (timestamp: 1577853000000) execute."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"INSERT INTO `tudou`.`kudu`(`id`, `user_id`, `name`)\nVALUES (1, 1, 'a');\n")),(0,l.kt)("p",null,"On 2020-01-01 12:31:00 (timestamp: 1577853060000) execute."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"DELETE\nFROM `tudou`.`kudu`\nWHERE `id` = 1\n  AND `user_id` = 1\n  AND `name` = 'a';\n")),(0,l.kt)("p",null,"On 2020-01-01 12:32:00 (timestamp: 1577853180000) execute."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"UPDATE `tudou`.`kudu`\nSET `id`      = 2,\n    `user_id` = 2,\n    `name`    = 'b'\nWHERE `id` = 1\n  AND `user_id` = 1\n  AND `name` = 'a';\n")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"pavingData = true, splitUpdate = false The data in RowData are, in order")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'//schema, table, ts, opTime, type, before_id, before_user_id, before_name, after_id, after_user_id, after_name\n["tudou", "kudu", 6760525407742726144, 1577853000000, "INSERT", null, null, null, null, 1, 1, "a"]\n["tudou", "kudu", 6760525407742726144, 1577853060000, "DELETE", 1, 1, "a", null, null, null, null]\n["tudou", "kudu", 6760525407742726144, 1577853180000, "UPDATE", 1, 1, "a", 2, 2, "b" ]\n')),(0,l.kt)("ol",{start:2},(0,l.kt)("li",{parentName:"ol"},"pavingData = false, splitUpdate = false The data in RowData are, in order")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'//schema, table, ts, opTime, type, before, after\n["tudou", "kudu", 6760525407742726144, 1577853000000, "INSERT", null, {"id":1, "user_id":1, "name": "a"}]\n["tudou", "kudu", 6760525407742726144, 1577853060000, "DELETE", {"id":1, "user_id":1, "name": "a"}, null]\n["tudou", "kudu", 6760525407742726144, 1577853180000, "UPDATE", {"id":1, "user_id":1, "name": "a"}, {"id":2, "user_id":2, "name": "b"}]\n')),(0,l.kt)("ol",{start:3},(0,l.kt)("li",{parentName:"ol"},"pavingData = true, splitUpdate = true The data in RowData are, in order")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'//schema, table, ts, opTime, type, before_id, before_user_id, before_name, after_id, after_user_id, after_name\n["tudou", "kudu", 6760525407742726144, 1577853000000, "INSERT", null, null, null, null, 1, 1, "a"]\n["tudou", "kudu", 6760525407742726144, 1577853060000, "DELETE", 1, 1, "a", null, null, null, null]\n\n//schema, table, ts, opTime, type, before_id, before_user_id, before_name\n["tudou", "kudu", 6760525407742726144, 1577853180000, "UPDATE_BEFORE", 1, 1, "a"]\n\n//schema, table, ts, opTime, type, after_id, after_user_id, after_name\n["tudou", "kudu", 6760525407742726144, 1577853180000, "UPDATE_AFTER", 2, 2, "b"]\n')),(0,l.kt)("ol",{start:4},(0,l.kt)("li",{parentName:"ol"},"pavingData = false, splitUpdate = true The data in RowData are, in order")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'//schema, table, ts, opTime, type, before, after\n["tudou", "kudu", 6760525407742726144, 1577853000000, "INSERT", null, {"id":1, "user_id":1, "name": "a"}]\n["tudou", "kudu", 6760525407742726144, 1577853060000, "DELETE", {"id":1, "user_id":1, "name": "a"}, null]\n//schema, table, ts, opTime, type, before\n["tudou", "kudu", 6760525407742726144, 1577853180000, "UPDATE_BEFORE", {"id":1, "user_id":1, "name": "a"}]\n//schema, table, ts, opTime, type, after\n["tudou", "kudu", 6760525407742726144, 1577853180000, "UPDATE_AFTER", {"id":2, "user_id":2, "name": "b"}]\n')),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"type: change type, INSERT, UPDATE, DELETE"),(0,l.kt)("li",{parentName:"ul"},"opTime: the execution time of SQL in the database"),(0,l.kt)("li",{parentName:"ul"},"ts: self-incrementing ID, not repeated, can be used for sorting, decoded as the event time of FlinkX, decoding rules\nare as follows:")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'long id=Long.parseLong("6760525407742726144");\n        long res=id>>22;\n        DateFormat sdf=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");\n        System.out.println(sdf.format(res)); //2021-01-28 19:54:21\n')),(0,l.kt)("h2",{id:"8-data-types"},"8. data types"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"SUPPORTED"),(0,l.kt)("th",{parentName:"tr",align:null},"DATA TYPE"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"YES"),(0,l.kt)("td",{parentName:"tr",align:null},"BIT, TINYINT24, INT, INTEGER, FLOAT, DOUBLE, REAL, LONG, BIGINT, DECIMAL, NUMERIC, BINARY, VARBINARY, DATE, TIME, TIMESTAMP, DATETIME, DATETIME2, SMALLDATETIME, CHAR, VARCHAR, NCHAR, NVARCHAR, TEXT")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"No"),(0,l.kt)("td",{parentName:"tr",align:null},"ROWVERSION, UNIQUEIDENTIFIER, CURSOR, TABLE, SQL_VARIANT")))),(0,l.kt)("h2",{id:"9-sample-scripts"},"9. Sample Scripts"),(0,l.kt)("p",null,"See the ",(0,l.kt)("inlineCode",{parentName:"p"},"flinkx-examples")," folder in the project."))}d.isMDXComponent=!0}}]);