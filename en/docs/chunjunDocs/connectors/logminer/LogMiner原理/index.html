<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/chunjun-web/en/blog/rss.xml" title="ChunJun 纯钧 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/chunjun-web/en/blog/atom.xml" title="ChunJun 纯钧 Atom Feed"><title data-rh="true">FlinkX Oracle LogMiner实时采集基本原理 | ChunJun 纯钧</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://dtstack.github.io/chunjun-web//chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner原理"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="FlinkX Oracle LogMiner实时采集基本原理 | ChunJun 纯钧"><meta data-rh="true" name="description" content="本文主要对Logminer基本原理以及如何使用和Flinkx与Logminer的集成进行介绍"><meta data-rh="true" property="og:description" content="本文主要对Logminer基本原理以及如何使用和Flinkx与Logminer的集成进行介绍"><link data-rh="true" rel="icon" href="/chunjun-web/en/img/logo-dark.svg"><link data-rh="true" rel="canonical" href="https://dtstack.github.io/chunjun-web//chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner原理"><link data-rh="true" rel="alternate" href="https://dtstack.github.io/chunjun-web//chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner原理" hreflang="en"><link data-rh="true" rel="alternate" href="https://dtstack.github.io/chunjun-web//chunjun-web/docs/chunjunDocs/connectors/logminer/LogMiner原理" hreflang="中文"><link data-rh="true" rel="alternate" href="https://dtstack.github.io/chunjun-web//chunjun-web/docs/chunjunDocs/connectors/logminer/LogMiner原理" hreflang="x-default"><link rel="stylesheet" href="/chunjun-web/en/assets/css/styles.89ec17d5.css">
<link rel="preload" href="/chunjun-web/en/assets/js/runtime~main.6edfbc16.js" as="script">
<link rel="preload" href="/chunjun-web/en/assets/js/main.610ed450.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/chunjun-web/en/"><div class="navbar__logo"><img src="/chunjun-web/en/img/logo-dark.svg" alt="ChunJun Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/chunjun-web/en/img/logo-dark.svg" alt="ChunJun Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">ChunJun 纯钧</b></a><a class="navbar__item navbar__link navbar__link--active" href="/chunjun-web/en/docs/chunjunDocs/intro">Docs</a><a class="navbar__item navbar__link" href="/chunjun-web/en/blog">Blog</a><a href="https://github.com/DTStack/chunjun/releases" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Download</a><a class="navbar__item navbar__link" href="/chunjun-web/en/docs/roadmap/intro">Roadmap</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner原理" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/chunjun-web/docs/chunjunDocs/connectors/logminer/LogMiner原理" target="_self" rel="noopener noreferrer" class="dropdown__link">中文（中国）</a></li></ul></div><a href="https://github.com/DTStack/chunjun" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/dirty-plugins">脏数据插件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/quickstart">QuickStart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/restore">Restore</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/chunjun-web/en/docs/chunjunDocs/connectors/binlog/binlog-source">Connectors</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/binlog/binlog-source">Binlog Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/clickhouse/clickhouse-lookup">ClickHouse Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/db2/db2-lookup">DB2 Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/dm/dm-sink">DM Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/doris/dorisbatch-sink">Doris Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/elasticsearch/es7-lookup">ElasticSearch Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/gbase/gbase-lookup">GBase Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/greenplum/greenplum-sink">Greenplum Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/hbase/hbase-lookup">Hbase Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/hdfs/hdfs-sink">HDFS Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/hive/hive-lookup">Hive Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/influxdb/influxdb-sink">Influx Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/kafka/kafka-sink">Kafka Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/kingbase/kingbase-sink">KingBase Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/kudu/kudu-lookup">Kudu Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner-source">LogMiner Connector</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner-source">LogMiner Source</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner原理">FlinkX Oracle LogMiner实时采集基本原理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner配置">Oracle配置LogMiner</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/mongodb/mongodb-sink">MongoDB Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/mysql/mysql-lookup">MySQL Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/oracle/oracle-lookup">Oracle Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/pgwal/PostgresCDC-Source-en">PG-Wal CDC Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/postgresql/postgres-lookup">PostgreSQL Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/saphana/saphana-sink">Saphana Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/sqlserver/sqlserver-lookup">SQL Server Connector</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/chunjun-web/en/docs/chunjunDocs/connectors/sqlservercdc/SqlserverCDC-Principles">SqlServer CDC Connector</a></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/contributing">Contributing to ChunJun</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/change-log">ChunJun 1.12 新特性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/contribute-pr">How to submit a good PR</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/docker">ChunJun Docker</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/chunjun-web/en/docs/chunjunDocs/formats/protobuf-x">formats</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/general-configuration">ChunJun generic configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chunjun-web/en/docs/chunjunDocs/incremental">What is incremental mode</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/chunjun-web/en/">🏠</a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">Connectors</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">LogMiner Connector</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner原理">FlinkX Oracle LogMiner实时采集基本原理</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>FlinkX Oracle LogMiner实时采集基本原理</h1><p>本文主要对Logminer基本原理以及如何使用和Flinkx与Logminer的集成进行介绍
通过本文你可以了解到：</p><ul><li>Logminer是什么</li><li>Logminer的使用</li><li>Flinkx如何和Logminer的集成</li></ul><h1>Logminer是什么？</h1><p>LogMiner 是Oracle公司从产品8i以后提供的一个实际非常有用的分析工具，使用该工具可以轻松获得Oracle 重做日志文件（归档日志文件）中的具体内容，LogMiner分析工具实际上是由一组PL/SQL包和一些动态视图组成，它作为Oracle数据库的一部分来发布，是oracle公司提供的一个完全免费的工具。</p><p>具体的说：
对用户数据或数据库字典所做的所有更改都记录在Oracle重做日志文件RedoLog中,Logminer就是一个解析RedoLog的工具，通过Logminer解析RedoLog可以得到对应的SQL数据。</p><p>Oracle 中的RedoLog写入流程:
Oracle重做日志采用<strong>循环写入</strong>的方式，每一个Oracle实例至少拥有<strong>2组日志组</strong>。Oracle重做日志一般由Oracle自动切换，重做日志文件在当LGWR进程停止写入并开始写入下一个日志组时发生切换，或在用户收到发出ALTER SYSTEM SWITCH LOGFILE时发生切换。如果Oracle数据库开启了归档功能，则在日志组发生切换的时候，上一个日志组的日志文件会被归档到归档目录里</p><p>从上面可知 Oracle里的RedoLog文件分为两种：</p><ul><li>当前写的日志组的文件,可通过 v$log 和 v$logfile 得到</li><li>归档的redoLog文件，可通过 v$archived_log 得到</li></ul><p>v$log 文档
<a href="https://docs.oracle.com/cd/B19306_01/server.102/b14237/dynviews_1150.htm#REFRN30127" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/cd/B19306_01/server.102/b14237/dynviews_1150.htm#REFRN30127</a></p><p>v$logfile 文档
<a href="https://docs.oracle.com/cd/B28359_01/server.111/b28320/dynviews_2031.htm#REFRN30129" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/cd/B28359_01/server.111/b28320/dynviews_2031.htm#REFRN30129</a></p><p>v$archived_log 文档
<a href="https://docs.oracle.com/cd/E18283_01/server.112/e17110/dynviews_1016.htm" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/cd/E18283_01/server.112/e17110/dynviews_1016.htm</a></p><p><strong>通过循环查找到最新符合要求的RedoLog并让Logminer加载分析，分析的数据在视图 v$logmnr_contents 里，通过读取 v$logmnr_contents 就可以得到 Oracle的实时数据</strong></p><h1>Logminer的使用</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="logminer的配置与开启">Logminer的配置与开启<a class="hash-link" href="#logminer的配置与开启" title="Direct link to heading">​</a></h2><p><a href="/chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner配置">Oracle配置LogMiner</a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="logminer的使用-1">Logminer的使用<a class="hash-link" href="#logminer的使用-1" title="Direct link to heading">​</a></h2><ol><li><p>指定LogMiner字典。</p></li><li><p>指定重做日志文件列表以进行分析。
使用 <code>DBMS_LOGMNR.ADD_LOGFILE</code> 过程，或指示LogMiner在启动LogMiner时自动创建要分析的日志文件列表（在步骤3中）。</p></li><li><p>启动LogMiner。
使用 <code>DBMS_LOGMNR.START_LOGMNR</code> 程序。</p></li><li><p>请求感兴趣的重做数据。
查询<code>V$LOGMNR_CONTENTS</code>视图。（您必须具有<code>SELECT ANY TRANSACTION</code>查询此视图的权限）</p></li><li><p>结束LogMiner会话。
使用 <code>DBMS_LOGMNR.END_LOGMNR</code> 程序</p></li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="logminer字典">Logminer字典<a class="hash-link" href="#logminer字典" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="logminer字典作用">LogMiner字典作用<a class="hash-link" href="#logminer字典作用" title="Direct link to heading">​</a></h4><p>Oracle数据字典记录当前所有表的信息，字段的信息等等。LogMiner使用字典将内部对象标识符和数据类型转换为对象名称和外部数据格式。如果没有字典，LogMiner将返回内部对象ID，并将数据显示为二进制数</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTO</span><span class="token plain"> HR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">JOBS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">JOB_ID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> JOB_TITLE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> MIN_SALARY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> MAX_SALARY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;IT_WT&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Technical Writer&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>没有字典，LogMiner将显示：</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">insert</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;UNKNOWN&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;OBJ# 45522&quot;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;COL 1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;COL 2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;COL 3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;COL 4&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">HEXTORAW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;45465f4748&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">HEXTORAW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;546563686e6963616c20577269746572&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HEXTORAW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;c229&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">HEXTORAW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;c3020b&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="logminer字典选项">Logminer字典选项<a class="hash-link" href="#logminer字典选项" title="Direct link to heading">​</a></h4><p>LogMiner字典的选项支持三种：</p><ul><li><p><a href="https://docs.oracle.com/cd/B19306_01/server.102/b14215/logminer.htm#i1014720" target="_blank" rel="noopener noreferrer">Using the Online Catalog</a>
Oracle recommends that you use this option when you will have access to the source database from which the redo log files were created and when no changes to the column definitions in the tables of interest are anticipated. This is the most efficient and easy-to-use option.</p></li><li><p><a href="https://docs.oracle.com/cd/B19306_01/server.102/b14215/logminer.htm#i1014735" target="_blank" rel="noopener noreferrer">Extracting a LogMiner Dictionary to the Redo Log Files</a>
Oracle recommends that you use this option when you do not expect to have access to the source database from which the redo log files were created, or if you anticipate that changes will be made to the column definitions in the tables of interest.</p></li><li><p><a href="https://docs.oracle.com/cd/B19306_01/server.102/b14215/logminer.htm#i1014763" target="_blank" rel="noopener noreferrer">Extracting the LogMiner Dictionary to a Flat File</a>
This option is maintained for backward compatibility with previous releases. This option does not guarantee transactional consistency. Oracle recommends that you use either the online catalog or extract the dictionary from redo log files instead.</p></li></ul><p>翻译：</p><ul><li><p><a href="https://docs.oracle.com/cd/B19306_01/server.102/b14215/logminer.htm#i1014720" target="_blank" rel="noopener noreferrer">使用在线目录</a>
当您可以访问从其创建重做日志文件的源数据库并且预计不会对目标表中的列定义进行任何更改时，Oracle建议您使用此选项。这是最有效和易于使用的选项。</p></li><li><p><a href="https://docs.oracle.com/cd/B19306_01/server.102/b14215/logminer.htm#i1014735" target="_blank" rel="noopener noreferrer">将LogMiner字典提取到重做日志文件</a>
如果您不希望访问创建重做日志文件的源数据库，或者希望对感兴趣的表中的列定义进行更改，则Oracle建议您使用此选项。</p></li><li><p><a href="https://docs.oracle.com/cd/B19306_01/server.102/b14215/logminer.htm#i1014763" target="_blank" rel="noopener noreferrer">将LogMiner字典提取到平面文件</a>
维护此选项是为了与以前的版本向后兼容。此选项不能保证事务的一致性。Oracle建议您使用联机目录或从重做日志文件中提取字典。</p></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="指定logminer重做日志文件">指定Logminer重做日志文件<a class="hash-link" href="#指定logminer重做日志文件" title="Direct link to heading">​</a></h3><p>要启动新的重做日志文件列表，需要使用   DBMS_LOGMNR.NEW 以表明这是新列表的开始</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">EXECUTE</span><span class="token plain"> DBMS_LOGMNR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ADD_LOGFILE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   LOGFILENAME </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/oracle/logs/log1.f&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   OPTIONS </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> DBMS_LOGMNR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">NEW</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>可以使用下列语句额外再添加日志文件</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">EXECUTE</span><span class="token plain"> DBMS_LOGMNR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ADD_LOGFILE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   LOGFILENAME </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/oracle/logs/log2.f&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   OPTIONS </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> DBMS_LOGMNR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ADDFILE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="启动logminer">启动LogMiner<a class="hash-link" href="#启动logminer" title="Direct link to heading">​</a></h3><p>使用  <code>DBMS_LOGMNR.START_LOGMN</code> 启动Logminer。可以指定参数：</p><ul><li><p>指定LogMiner如何过滤返回的数据（例如，通过开始和结束时间或SCN值）</p></li><li><p>指定用于格式化LogMiner返回的数据的选项</p></li><li><p>指定要使用的LogMiner词典</p></li></ul><p>主要的参数有：</p><div class="codeBlockContainer_I0IT language-text theme-code-block"><div class="codeBlockContent_wNvx text"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">   OPTIONS参数说明:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * DBMS_LOGMNR.SKIP_CORRUPTION - 跳过出错的redlog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * DBMS_LOGMNR.NO_SQL_DELIMITER - 不使用 &#x27;;&#x27;分割redo sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * DBMS_LOGMNR.NO_ROWID_IN_STMT - 默认情况下，用于UPDATE和DELETE操作的SQL_REDO和SQL_UNDO语句在where子句中包含“ ROWID =”。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *                                但是，这对于想要重新执行SQL语句的应用程序是不方便的。设置此选项后，“ ROWID”不会放置在重构语句的末尾</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * DBMS_LOGMNR.DICT_FROM_ONLINE_CATALOG - 使用在线字典</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * DBMS_LOGMNR.CONTINUOUS_MINE - 需要在生成重做日志的同一实例中使用日志</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * DBMS_LOGMNR.COMMITTED_DATA_ONLY - 指定此选项时，LogMiner将属于同一事务的所有DML操作分组在一起。事务按提交顺序返回。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * DBMS_LOGMNR.STRING_LITERALS_IN_STMT - 默认情况下，格式化格式化的SQL语句时，SQL_REDO和SQL_UNDO语句会使用数据库会话的NLS设置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *                                       例如NLS_DATE_FORMAT，NLS_NUMERIC_CHARACTERS等）。使用此选项，将使用ANSI / ISO字符串文字格式对重构的SQL语句进行格式化。</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>示例</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">EXECUTE</span><span class="token plain"> DBMS_LOGMNR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">START_LOGMNR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   STARTTIME </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;01-Jan-2003 08:30:00&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ENDTIME </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;01-Jan-2003 08:45:00&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   OPTIONS </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> DBMS_LOGMNR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DICT_FROM_ONLINE_CATALOG </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   DBMS_LOGMNR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CONTINUOUS_MINE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="在v-logmnr_contents中查询感兴趣的重做数据">在V$ LOGMNR_CONTENTS中查询感兴趣的重做数据<a class="hash-link" href="#在v-logmnr_contents中查询感兴趣的重做数据" title="Direct link to heading">​</a></h3><p>Logminer会解析redoLog里的日志加载到 v$LOGMNR_CONTENTS 视图里，我们只需要使用 sql查询 即可获取对应数据
v$LOGMNR_CONTENTS视图相关字段
<a href="https://docs.oracle.com/cd/B19306_01/server.102/b14237/dynviews_1154.htm" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/cd/B19306_01/server.102/b14237/dynviews_1154.htm</a></p><p>主要字段有：</p><table><thead><tr><th>列</th><th>数据类型</th><th>描述</th></tr></thead><tbody><tr><td>SCN</td><td>NUMBER</td><td>oracle为每个已提交的事务分配唯一的scn</td></tr><tr><td>OPERATION</td><td>VARCHAR2(32)</td><td>INSERT UPDATE DELETE DDL COMMIT ROLLBACK.....</td></tr><tr><td>SEG_OWNER</td><td>VARCHAR2(32)</td><td>schema</td></tr><tr><td>TABLE_NAME</td><td>VARCHAR2(32)</td><td>表名</td></tr><tr><td>TIMESTAMP</td><td>DATE</td><td>数据库变动时间戳</td></tr><tr><td>SQL_REDO</td><td>VARCHAR2(4000)</td><td>重建的SQL语句，该语句等效于进行更改的原始SQL语句</td></tr></tbody></table><p>示例</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">timestamp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    operation</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    seg_owner</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    table_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sql_redo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    row_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    csf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    v$logmnr_contents</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scn </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ?</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>查询出来的数据示例：</p><div align="center"><img src="../../images/LogMiner/LogMiner23.png"></div><h1>Flinkx如何使用Logminer</h1><p>使用Logminer在于关键2步骤：</p><ul><li>找到需要分析的Redolog日志，加载到Logminer</li><li>开启Logminer,在  v$LOGMNR_CONTENTS 查询感兴趣数据</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="1-查找redolog文件">1. 查找RedoLog文件<a class="hash-link" href="#1-查找redolog文件" title="Direct link to heading">​</a></h3><p>从上面介绍中 我们可以知道 Redolog来源于日志组和归档日志里，所以flinkx 根据SCN号查询日志组以及归档日志获取到对应的文件</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">MIN</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    first_change</span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">MIN</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">member</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            first_change</span><span class="token comment" style="color:#999988;font-style:italic">#,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token number" style="color:#36acaa">281474976710655</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> next_change</span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            v$log       l</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">INNER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">JOIN</span><span class="token plain"> v$logfile   f </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">group</span><span class="token comment" style="color:#999988;font-style:italic"># = f.group#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">STATUS</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;CURRENT&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">STATUS</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ACTIVE&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            first_change</span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">UNION</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            first_change</span><span class="token comment" style="color:#999988;font-style:italic">#,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            next_change</span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            v$archived_log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            name </span><span class="token operator" style="color:#393A34">IS</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    first_change</span><span class="token comment" style="color:#999988;font-style:italic"># &gt;= ?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> ? </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> next_change</span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    first_change</span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    first_change</span><span class="token comment" style="color:#999988;font-style:italic">#</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>查询出来的数据示例：</p><div align="center"><img src="../../images/LogMiner/LogMiner21.png"></div>注意： 如果Logminer的处理速度比Oracle产生数据速度快，那么理论上Flinkx只需要加载日志组文件不需要加载归档日志文件，而Logminer加载文件会比较消耗资源，所以会先进行RedoLog文件的查找，如果本次查找的文件和上次的没有区别，说明Logminer不需要加载新的日志文件，只需要重新再从视图里查询数据即可<h3 class="anchor anchorWithStickyNavbar_mojV" id="2-加载文件到logminer">2. 加载文件到Logminer<a class="hash-link" href="#2-加载文件到logminer" title="Direct link to heading">​</a></h3><p>通过一个存储过程 查询到日志文件之后 加载到Logminer里 并开启Logminer</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">DECLARE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    st          </span><span class="token keyword" style="color:#00009f">BOOLEAN</span><span class="token plain"> :</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    start_scn   NUMBER :</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ?</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">BEGIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">FOR</span><span class="token plain"> l_log_rec </span><span class="token operator" style="color:#393A34">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">MIN</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            first_change</span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token function" style="color:#d73a49">MIN</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">member</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    first_change</span><span class="token comment" style="color:#999988;font-style:italic">#,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token number" style="color:#36acaa">281474976710655</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> next_change</span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    v$log       l</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">INNER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">JOIN</span><span class="token plain"> v$logfile   f </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">group</span><span class="token comment" style="color:#999988;font-style:italic"># = f.group#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">STATUS</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;CURRENT&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">STATUS</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ACTIVE&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    first_change</span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">UNION</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    first_change</span><span class="token comment" style="color:#999988;font-style:italic">#,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    next_change</span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    v$archived_log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    name </span><span class="token operator" style="color:#393A34">IS</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            first_change</span><span class="token comment" style="color:#999988;font-style:italic"># &gt;= start_scn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> start_scn </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> next_change</span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            first_change</span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            first_change</span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">LOOP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> st </span><span class="token keyword" style="color:#00009f">THEN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SYS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBMS_LOGMNR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_logfile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">l_log_rec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SYS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBMS_LOGMNR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">new</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        st :</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">ELSE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SYS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBMS_LOGMNR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_logfile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">l_log_rec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">END</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">IF</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">END</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">LOOP</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SYS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBMS_LOGMNR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">start_logmnr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">       options </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">          SYS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBMS_LOGMNR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">skip_corruption        </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> SYS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBMS_LOGMNR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">no_sql_delimiter        </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> SYS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBMS_LOGMNR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">no_rowid_in_stmt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> SYS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBMS_LOGMNR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dict_from_online_catalog        </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> SYS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBMS_LOGMNR</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">string_literals_in_stmt   </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">END</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="3-查询数据">3. 查询数据<a class="hash-link" href="#3-查询数据" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">timestamp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    operation</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    seg_owner</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    table_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sql_redo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    row_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    csf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    v$logmnr_contents</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scn </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ?</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Flinkx就是在一个循环里 执行上述sql语句查询数据。 查询日志文件，加载到logminer，开启logminer，读取数据，更新当前最新SCN号，当数据读取完毕，代表本次加载的日志文件加载完了，通过SCN号寻找后续日志文件，重复上述操作</p><div align="center"><img src="../../images/LogMiner/LogMiner22.png"></div><p>从 v$logmnr_contents获取到数据之后，Flinkx 使用 net.sf.jsqlparser.parser.CCJSqlParserUtil 来解析 sql_redo 值
获取到的sql_redo语句格式示例：</p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx json"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">insert into </span><span class="token string" style="color:#e3116c">&quot;TUDOU&quot;</span><span class="token plain">.</span><span class="token string" style="color:#e3116c">&quot;CDC&quot;</span><span class="token plain">(</span><span class="token string" style="color:#e3116c">&quot;ID&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;USER_ID&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;NAME&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;date1&quot;</span><span class="token plain">) values (&#x27;</span><span class="token number" style="color:#36acaa">19</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">&#x27;</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">&#x27;b&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">TO_DATE(&#x27;</span><span class="token number" style="color:#36acaa">2021</span><span class="token number" style="color:#36acaa">-01</span><span class="token number" style="color:#36acaa">-29</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">25</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">50</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> &#x27;YYYY-MM-DD HH24</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">MI</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">SS&#x27;))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>使用net.sf.jsqlparser.parser.CCJSqlParserUtil 解析上述SQL获取各个字段的值</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="oracle10-和oracle11的部分区别">Oracle10 和Oracle11的部分区别<a class="hash-link" href="#oracle10-和oracle11的部分区别" title="Direct link to heading">​</a></h3><ol><li>v$LOGMNR_CONTENTS 里Oracle10 比 Oracle11 少了 commit_scn字段</li><li>日志组字段里没有next_change#字段</li><li>如果Sql里含有ToDate函数，Logminer10的sql_redo加载的是ToDate函数日期格式默认是DD-MON-RR格式，而Logminer11则是Todate函数执行后的值，所以Logminer10会在获取连接的时候，执行下列SQL,设置日期格式，FLinkx再对其进行正则匹配，替换得到最终的值。</li></ol><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//修改当前会话的date日期格式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> final static String SQL_ALTER_DATE_FORMAT </span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;ALTER SESSION SET NLS_DATE_FORMAT = &#x27;YYYY-MM-DD HH24:MI:SS&#x27;&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//修改当前会话的timestamp日期格式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> final static String NLS_TIMESTAMP_FORMAT </span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;ALTER SESSION SET NLS_TIMESTAMP_FORMAT = &#x27;YYYY-MM-DD HH24:MI:SS.FF6&#x27;&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/chunjunDocs/connectors/logminer/LogMiner原理.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner-source"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">LogMiner Source</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner配置"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Oracle配置LogMiner</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#logminer的配置与开启" class="table-of-contents__link toc-highlight">Logminer的配置与开启</a></li><li><a href="#logminer的使用-1" class="table-of-contents__link toc-highlight">Logminer的使用</a><ul><li><a href="#logminer字典" class="table-of-contents__link toc-highlight">Logminer字典</a></li><li><a href="#指定logminer重做日志文件" class="table-of-contents__link toc-highlight">指定Logminer重做日志文件</a></li><li><a href="#启动logminer" class="table-of-contents__link toc-highlight">启动LogMiner</a></li><li><a href="#在v-logmnr_contents中查询感兴趣的重做数据" class="table-of-contents__link toc-highlight">在V$ LOGMNR_CONTENTS中查询感兴趣的重做数据</a></li><li><a href="#1-查找redolog文件" class="table-of-contents__link toc-highlight">1. 查找RedoLog文件</a></li><li><a href="#2-加载文件到logminer" class="table-of-contents__link toc-highlight">2. 加载文件到Logminer</a></li><li><a href="#3-查询数据" class="table-of-contents__link toc-highlight">3. 查询数据</a></li><li><a href="#oracle10-和oracle11的部分区别" class="table-of-contents__link toc-highlight">Oracle10 和Oracle11的部分区别</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/chunjun-web/en/docs/chunjunDocs/quickstart">快速上手</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/DTStack/chunjun/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Issue Tracker<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/DTStack/chunjun/pulls" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Pull Requests<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/DTStack/chunjun/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/chunjun-web/en/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/DTStack/chunjun" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 DTStack, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/chunjun-web/en/assets/js/runtime~main.6edfbc16.js"></script>
<script src="/chunjun-web/en/assets/js/main.610ed450.js"></script>
</body>
</html>