"use strict";(self.webpackChunkchunjun_web=self.webpackChunkchunjun_web||[]).push([[7278],{3905:function(e,n,t){t.d(n,{Zo:function(){return s},kt:function(){return N}});var r=t(7294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,l=function(e,n){if(null==e)return{};var t,r,l={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var c=r.createContext({}),m=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},s=function(e){var n=m(e.components);return r.createElement(c.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},g=r.forwardRef((function(e,n){var t=e.components,l=e.mdxType,a=e.originalType,c=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),g=m(t),N=l,u=g["".concat(c,".").concat(N)]||g[N]||p[N]||a;return t?r.createElement(u,o(o({ref:n},s),{},{components:t})):r.createElement(u,o({ref:n},s))}));function N(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var a=t.length,o=new Array(a);o[0]=g;var i={};for(var c in n)hasOwnProperty.call(n,c)&&(i[c]=n[c]);i.originalType=e,i.mdxType="string"==typeof e?e:l,o[1]=i;for(var m=2;m<a;m++)o[m]=t[m];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}g.displayName="MDXCreateElement"},1807:function(e,n,t){t.r(n),t.d(n,{assets:function(){return s},contentTitle:function(){return c},default:function(){return N},frontMatter:function(){return i},metadata:function(){return m},toc:function(){return p}});var r=t(7462),l=t(3366),a=(t(7294),t(3905)),o=["components"],i={},c="FlinkX Oracle LogMiner\u5b9e\u65f6\u91c7\u96c6\u57fa\u672c\u539f\u7406",m={unversionedId:"chunjunDocs/connectors/logminer/LogMiner\u539f\u7406",id:"chunjunDocs/connectors/logminer/LogMiner\u539f\u7406",title:"FlinkX Oracle LogMiner\u5b9e\u65f6\u91c7\u96c6\u57fa\u672c\u539f\u7406",description:"\u672c\u6587\u4e3b\u8981\u5bf9Logminer\u57fa\u672c\u539f\u7406\u4ee5\u53ca\u5982\u4f55\u4f7f\u7528\u548cFlinkx\u4e0eLogminer\u7684\u96c6\u6210\u8fdb\u884c\u4ecb\u7ecd",source:"@site/docs/chunjunDocs/connectors/logminer/LogMiner\u539f\u7406.md",sourceDirName:"chunjunDocs/connectors/logminer",slug:"/chunjunDocs/connectors/logminer/LogMiner\u539f\u7406",permalink:"/chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner\u539f\u7406",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/chunjunDocs/connectors/logminer/LogMiner\u539f\u7406.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"LogMiner Source",permalink:"/chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner-source"},next:{title:"Oracle\u914d\u7f6eLogMiner",permalink:"/chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner\u914d\u7f6e"}},s={},p=[{value:"Logminer\u7684\u914d\u7f6e\u4e0e\u5f00\u542f",id:"logminer\u7684\u914d\u7f6e\u4e0e\u5f00\u542f",level:2},{value:"Logminer\u7684\u4f7f\u7528",id:"logminer\u7684\u4f7f\u7528-1",level:2},{value:"Logminer\u5b57\u5178",id:"logminer\u5b57\u5178",level:3},{value:"LogMiner\u5b57\u5178\u4f5c\u7528",id:"logminer\u5b57\u5178\u4f5c\u7528",level:4},{value:"Logminer\u5b57\u5178\u9009\u9879",id:"logminer\u5b57\u5178\u9009\u9879",level:4},{value:"\u6307\u5b9aLogminer\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6",id:"\u6307\u5b9alogminer\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6",level:3},{value:"\u542f\u52a8LogMiner",id:"\u542f\u52a8logminer",level:3},{value:"\u5728V$ LOGMNR_CONTENTS\u4e2d\u67e5\u8be2\u611f\u5174\u8da3\u7684\u91cd\u505a\u6570\u636e",id:"\u5728v-logmnr_contents\u4e2d\u67e5\u8be2\u611f\u5174\u8da3\u7684\u91cd\u505a\u6570\u636e",level:3},{value:"1. \u67e5\u627eRedoLog\u6587\u4ef6",id:"1-\u67e5\u627eredolog\u6587\u4ef6",level:3},{value:"2. \u52a0\u8f7d\u6587\u4ef6\u5230Logminer",id:"2-\u52a0\u8f7d\u6587\u4ef6\u5230logminer",level:3},{value:"3. \u67e5\u8be2\u6570\u636e",id:"3-\u67e5\u8be2\u6570\u636e",level:3},{value:"Oracle10 \u548cOracle11\u7684\u90e8\u5206\u533a\u522b",id:"oracle10-\u548coracle11\u7684\u90e8\u5206\u533a\u522b",level:3}],g={toc:p};function N(e){var n=e.components,t=(0,l.Z)(e,o);return(0,a.kt)("wrapper",(0,r.Z)({},g,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"flinkx-oracle-logminer\u5b9e\u65f6\u91c7\u96c6\u57fa\u672c\u539f\u7406"},"FlinkX Oracle LogMiner\u5b9e\u65f6\u91c7\u96c6\u57fa\u672c\u539f\u7406"),(0,a.kt)("p",null,"\u672c\u6587\u4e3b\u8981\u5bf9Logminer\u57fa\u672c\u539f\u7406\u4ee5\u53ca\u5982\u4f55\u4f7f\u7528\u548cFlinkx\u4e0eLogminer\u7684\u96c6\u6210\u8fdb\u884c\u4ecb\u7ecd\n\u901a\u8fc7\u672c\u6587\u4f60\u53ef\u4ee5\u4e86\u89e3\u5230\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Logminer\u662f\u4ec0\u4e48"),(0,a.kt)("li",{parentName:"ul"},"Logminer\u7684\u4f7f\u7528"),(0,a.kt)("li",{parentName:"ul"},"Flinkx\u5982\u4f55\u548cLogminer\u7684\u96c6\u6210")),(0,a.kt)("h1",{id:"logminer\u662f\u4ec0\u4e48"},"Logminer\u662f\u4ec0\u4e48\uff1f"),(0,a.kt)("p",null,"LogMiner \u662fOracle\u516c\u53f8\u4ece\u4ea7\u54c18i\u4ee5\u540e\u63d0\u4f9b\u7684\u4e00\u4e2a\u5b9e\u9645\u975e\u5e38\u6709\u7528\u7684\u5206\u6790\u5de5\u5177\uff0c\u4f7f\u7528\u8be5\u5de5\u5177\u53ef\u4ee5\u8f7b\u677e\u83b7\u5f97Oracle \u91cd\u505a\u65e5\u5fd7\u6587\u4ef6\uff08\u5f52\u6863\u65e5\u5fd7\u6587\u4ef6\uff09\u4e2d\u7684\u5177\u4f53\u5185\u5bb9\uff0cLogMiner\u5206\u6790\u5de5\u5177\u5b9e\u9645\u4e0a\u662f\u7531\u4e00\u7ec4PL/SQL\u5305\u548c\u4e00\u4e9b\u52a8\u6001\u89c6\u56fe\u7ec4\u6210\uff0c\u5b83\u4f5c\u4e3aOracle\u6570\u636e\u5e93\u7684\u4e00\u90e8\u5206\u6765\u53d1\u5e03\uff0c\u662foracle\u516c\u53f8\u63d0\u4f9b\u7684\u4e00\u4e2a\u5b8c\u5168\u514d\u8d39\u7684\u5de5\u5177\u3002"),(0,a.kt)("p",null,"\u5177\u4f53\u7684\u8bf4\uff1a\n\u5bf9\u7528\u6237\u6570\u636e\u6216\u6570\u636e\u5e93\u5b57\u5178\u6240\u505a\u7684\u6240\u6709\u66f4\u6539\u90fd\u8bb0\u5f55\u5728Oracle\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6RedoLog\u4e2d,Logminer\u5c31\u662f\u4e00\u4e2a\u89e3\u6790RedoLog\u7684\u5de5\u5177\uff0c\u901a\u8fc7Logminer\u89e3\u6790RedoLog\u53ef\u4ee5\u5f97\u5230\u5bf9\u5e94\u7684SQL\u6570\u636e\u3002"),(0,a.kt)("p",null,"Oracle \u4e2d\u7684RedoLog\u5199\u5165\u6d41\u7a0b:\nOracle\u91cd\u505a\u65e5\u5fd7\u91c7\u7528",(0,a.kt)("strong",{parentName:"p"},"\u5faa\u73af\u5199\u5165"),"\u7684\u65b9\u5f0f\uff0c\u6bcf\u4e00\u4e2aOracle\u5b9e\u4f8b\u81f3\u5c11\u62e5\u6709",(0,a.kt)("strong",{parentName:"p"},"2\u7ec4\u65e5\u5fd7\u7ec4"),"\u3002Oracle\u91cd\u505a\u65e5\u5fd7\u4e00\u822c\u7531Oracle\u81ea\u52a8\u5207\u6362\uff0c\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6\u5728\u5f53LGWR\u8fdb\u7a0b\u505c\u6b62\u5199\u5165\u5e76\u5f00\u59cb\u5199\u5165\u4e0b\u4e00\u4e2a\u65e5\u5fd7\u7ec4\u65f6\u53d1\u751f\u5207\u6362\uff0c\u6216\u5728\u7528\u6237\u6536\u5230\u53d1\u51faALTER SYSTEM SWITCH LOGFILE\u65f6\u53d1\u751f\u5207\u6362\u3002\u5982\u679cOracle\u6570\u636e\u5e93\u5f00\u542f\u4e86\u5f52\u6863\u529f\u80fd\uff0c\u5219\u5728\u65e5\u5fd7\u7ec4\u53d1\u751f\u5207\u6362\u7684\u65f6\u5019\uff0c\u4e0a\u4e00\u4e2a\u65e5\u5fd7\u7ec4\u7684\u65e5\u5fd7\u6587\u4ef6\u4f1a\u88ab\u5f52\u6863\u5230\u5f52\u6863\u76ee\u5f55\u91cc"),(0,a.kt)("p",null,"\u4ece\u4e0a\u9762\u53ef\u77e5 Oracle\u91cc\u7684RedoLog\u6587\u4ef6\u5206\u4e3a\u4e24\u79cd\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u5f53\u524d\u5199\u7684\u65e5\u5fd7\u7ec4\u7684\u6587\u4ef6,\u53ef\u901a\u8fc7 v$log \u548c v$logfile \u5f97\u5230"),(0,a.kt)("li",{parentName:"ul"},"\u5f52\u6863\u7684redoLog\u6587\u4ef6\uff0c\u53ef\u901a\u8fc7 v$archived_log \u5f97\u5230")),(0,a.kt)("p",null,"v$log \u6587\u6863\n",(0,a.kt)("a",{parentName:"p",href:"https://docs.oracle.com/cd/B19306_01/server.102/b14237/dynviews_1150.htm#REFRN30127"},"https://docs.oracle.com/cd/B19306_01/server.102/b14237/dynviews_1150.htm#REFRN30127")),(0,a.kt)("p",null,"v$logfile \u6587\u6863\n",(0,a.kt)("a",{parentName:"p",href:"https://docs.oracle.com/cd/B28359_01/server.111/b28320/dynviews_2031.htm#REFRN30129"},"https://docs.oracle.com/cd/B28359_01/server.111/b28320/dynviews_2031.htm#REFRN30129")),(0,a.kt)("p",null,"v$archived_log \u6587\u6863\n",(0,a.kt)("a",{parentName:"p",href:"https://docs.oracle.com/cd/E18283_01/server.112/e17110/dynviews_1016.htm"},"https://docs.oracle.com/cd/E18283_01/server.112/e17110/dynviews_1016.htm")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u901a\u8fc7\u5faa\u73af\u67e5\u627e\u5230\u6700\u65b0\u7b26\u5408\u8981\u6c42\u7684RedoLog\u5e76\u8ba9Logminer\u52a0\u8f7d\u5206\u6790\uff0c\u5206\u6790\u7684\u6570\u636e\u5728\u89c6\u56fe v$logmnr_contents \u91cc\uff0c\u901a\u8fc7\u8bfb\u53d6 v$logmnr_contents \u5c31\u53ef\u4ee5\u5f97\u5230 Oracle\u7684\u5b9e\u65f6\u6570\u636e")),(0,a.kt)("h1",{id:"logminer\u7684\u4f7f\u7528"},"Logminer\u7684\u4f7f\u7528"),(0,a.kt)("h2",{id:"logminer\u7684\u914d\u7f6e\u4e0e\u5f00\u542f"},"Logminer\u7684\u914d\u7f6e\u4e0e\u5f00\u542f"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"/chunjun-web/en/docs/chunjunDocs/connectors/logminer/LogMiner%E9%85%8D%E7%BD%AE"},"Oracle\u914d\u7f6eLogMiner")),(0,a.kt)("h2",{id:"logminer\u7684\u4f7f\u7528-1"},"Logminer\u7684\u4f7f\u7528"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u6307\u5b9aLogMiner\u5b57\u5178\u3002")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u6307\u5b9a\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6\u5217\u8868\u4ee5\u8fdb\u884c\u5206\u6790\u3002\n\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"DBMS_LOGMNR.ADD_LOGFILE")," \u8fc7\u7a0b\uff0c\u6216\u6307\u793aLogMiner\u5728\u542f\u52a8LogMiner\u65f6\u81ea\u52a8\u521b\u5efa\u8981\u5206\u6790\u7684\u65e5\u5fd7\u6587\u4ef6\u5217\u8868\uff08\u5728\u6b65\u9aa43\u4e2d\uff09\u3002")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u542f\u52a8LogMiner\u3002\n\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"DBMS_LOGMNR.START_LOGMNR")," \u7a0b\u5e8f\u3002")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u8bf7\u6c42\u611f\u5174\u8da3\u7684\u91cd\u505a\u6570\u636e\u3002\n\u67e5\u8be2",(0,a.kt)("inlineCode",{parentName:"p"},"V$LOGMNR_CONTENTS"),"\u89c6\u56fe\u3002\uff08\u60a8\u5fc5\u987b\u5177\u6709",(0,a.kt)("inlineCode",{parentName:"p"},"SELECT ANY TRANSACTION"),"\u67e5\u8be2\u6b64\u89c6\u56fe\u7684\u6743\u9650\uff09")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u7ed3\u675fLogMiner\u4f1a\u8bdd\u3002\n\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"DBMS_LOGMNR.END_LOGMNR")," \u7a0b\u5e8f"))),(0,a.kt)("h3",{id:"logminer\u5b57\u5178"},"Logminer\u5b57\u5178"),(0,a.kt)("h4",{id:"logminer\u5b57\u5178\u4f5c\u7528"},"LogMiner\u5b57\u5178\u4f5c\u7528"),(0,a.kt)("p",null,"Oracle\u6570\u636e\u5b57\u5178\u8bb0\u5f55\u5f53\u524d\u6240\u6709\u8868\u7684\u4fe1\u606f\uff0c\u5b57\u6bb5\u7684\u4fe1\u606f\u7b49\u7b49\u3002LogMiner\u4f7f\u7528\u5b57\u5178\u5c06\u5185\u90e8\u5bf9\u8c61\u6807\u8bc6\u7b26\u548c\u6570\u636e\u7c7b\u578b\u8f6c\u6362\u4e3a\u5bf9\u8c61\u540d\u79f0\u548c\u5916\u90e8\u6570\u636e\u683c\u5f0f\u3002\u5982\u679c\u6ca1\u6709\u5b57\u5178\uff0cLogMiner\u5c06\u8fd4\u56de\u5185\u90e8\u5bf9\u8c61ID\uff0c\u5e76\u5c06\u6570\u636e\u663e\u793a\u4e3a\u4e8c\u8fdb\u5236\u6570"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"INSERT INTO HR.JOBS(JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)  VALUES('IT_WT','Technical Writer', 4000, 11000);\n\n")),(0,a.kt)("p",null,"\u6ca1\u6709\u5b57\u5178\uff0cLogMiner\u5c06\u663e\u793a\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},'insert into "UNKNOWN"."OBJ# 45522"("COL 1","COL 2","COL 3","COL 4") values\n(HEXTORAW(\'45465f4748\'),HEXTORAW(\'546563686e6963616c20577269746572\'),\nHEXTORAW(\'c229\'),HEXTORAW(\'c3020b\'));\n')),(0,a.kt)("h4",{id:"logminer\u5b57\u5178\u9009\u9879"},"Logminer\u5b57\u5178\u9009\u9879"),(0,a.kt)("p",null,"LogMiner\u5b57\u5178\u7684\u9009\u9879\u652f\u6301\u4e09\u79cd\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://docs.oracle.com/cd/B19306_01/server.102/b14215/logminer.htm#i1014720"},"Using the Online Catalog"),"\nOracle recommends that you use this option when you will have access to the source database from which the redo log files were created and when no changes to the column definitions in the tables of interest are anticipated. This is the most efficient and easy-to-use option.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://docs.oracle.com/cd/B19306_01/server.102/b14215/logminer.htm#i1014735"},"Extracting a LogMiner Dictionary to the Redo Log Files"),"\nOracle recommends that you use this option when you do not expect to have access to the source database from which the redo log files were created, or if you anticipate that changes will be made to the column definitions in the tables of interest.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://docs.oracle.com/cd/B19306_01/server.102/b14215/logminer.htm#i1014763"},"Extracting the LogMiner Dictionary to a Flat File"),"\nThis option is maintained for backward compatibility with previous releases. This option does not guarantee transactional consistency. Oracle recommends that you use either the online catalog or extract the dictionary from redo log files instead."))),(0,a.kt)("p",null,"\u7ffb\u8bd1\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://docs.oracle.com/cd/B19306_01/server.102/b14215/logminer.htm#i1014720"},"\u4f7f\u7528\u5728\u7ebf\u76ee\u5f55"),"\n\u5f53\u60a8\u53ef\u4ee5\u8bbf\u95ee\u4ece\u5176\u521b\u5efa\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6\u7684\u6e90\u6570\u636e\u5e93\u5e76\u4e14\u9884\u8ba1\u4e0d\u4f1a\u5bf9\u76ee\u6807\u8868\u4e2d\u7684\u5217\u5b9a\u4e49\u8fdb\u884c\u4efb\u4f55\u66f4\u6539\u65f6\uff0cOracle\u5efa\u8bae\u60a8\u4f7f\u7528\u6b64\u9009\u9879\u3002\u8fd9\u662f\u6700\u6709\u6548\u548c\u6613\u4e8e\u4f7f\u7528\u7684\u9009\u9879\u3002")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://docs.oracle.com/cd/B19306_01/server.102/b14215/logminer.htm#i1014735"},"\u5c06LogMiner\u5b57\u5178\u63d0\u53d6\u5230\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6"),"\n\u5982\u679c\u60a8\u4e0d\u5e0c\u671b\u8bbf\u95ee\u521b\u5efa\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6\u7684\u6e90\u6570\u636e\u5e93\uff0c\u6216\u8005\u5e0c\u671b\u5bf9\u611f\u5174\u8da3\u7684\u8868\u4e2d\u7684\u5217\u5b9a\u4e49\u8fdb\u884c\u66f4\u6539\uff0c\u5219Oracle\u5efa\u8bae\u60a8\u4f7f\u7528\u6b64\u9009\u9879\u3002")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://docs.oracle.com/cd/B19306_01/server.102/b14215/logminer.htm#i1014763"},"\u5c06LogMiner\u5b57\u5178\u63d0\u53d6\u5230\u5e73\u9762\u6587\u4ef6"),"\n\u7ef4\u62a4\u6b64\u9009\u9879\u662f\u4e3a\u4e86\u4e0e\u4ee5\u524d\u7684\u7248\u672c\u5411\u540e\u517c\u5bb9\u3002\u6b64\u9009\u9879\u4e0d\u80fd\u4fdd\u8bc1\u4e8b\u52a1\u7684\u4e00\u81f4\u6027\u3002Oracle\u5efa\u8bae\u60a8\u4f7f\u7528\u8054\u673a\u76ee\u5f55\u6216\u4ece\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6\u4e2d\u63d0\u53d6\u5b57\u5178\u3002"))),(0,a.kt)("h3",{id:"\u6307\u5b9alogminer\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6"},"\u6307\u5b9aLogminer\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6"),(0,a.kt)("p",null,"\u8981\u542f\u52a8\u65b0\u7684\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6\u5217\u8868\uff0c\u9700\u8981\u4f7f\u7528  \xa0DBMS_LOGMNR.NEW \u4ee5\u8868\u660e\u8fd9\u662f\u65b0\u5217\u8868\u7684\u5f00\u59cb"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"EXECUTE DBMS_LOGMNR.ADD_LOGFILE( \n   LOGFILENAME => '/oracle/logs/log1.f',\n   OPTIONS => DBMS_LOGMNR.NEW);\n")),(0,a.kt)("p",null,"\u53ef\u4ee5\u4f7f\u7528\u4e0b\u5217\u8bed\u53e5\u989d\u5916\u518d\u6dfb\u52a0\u65e5\u5fd7\u6587\u4ef6"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"EXECUTE DBMS_LOGMNR.ADD_LOGFILE( \n   LOGFILENAME => '/oracle/logs/log2.f', \n   OPTIONS => DBMS_LOGMNR.ADDFILE);\n")),(0,a.kt)("h3",{id:"\u542f\u52a8logminer"},"\u542f\u52a8LogMiner"),(0,a.kt)("p",null,"\u4f7f\u7528  ",(0,a.kt)("inlineCode",{parentName:"p"},"DBMS_LOGMNR.START_LOGMN")," \u542f\u52a8Logminer\u3002\u53ef\u4ee5\u6307\u5b9a\u53c2\u6570\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u6307\u5b9aLogMiner\u5982\u4f55\u8fc7\u6ee4\u8fd4\u56de\u7684\u6570\u636e\uff08\u4f8b\u5982\uff0c\u901a\u8fc7\u5f00\u59cb\u548c\u7ed3\u675f\u65f6\u95f4\u6216SCN\u503c\uff09")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u6307\u5b9a\u7528\u4e8e\u683c\u5f0f\u5316LogMiner\u8fd4\u56de\u7684\u6570\u636e\u7684\u9009\u9879")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"\u6307\u5b9a\u8981\u4f7f\u7528\u7684LogMiner\u8bcd\u5178"))),(0,a.kt)("p",null,"\u4e3b\u8981\u7684\u53c2\u6570\u6709\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"   OPTIONS\u53c2\u6570\u8bf4\u660e:\n     * DBMS_LOGMNR.SKIP_CORRUPTION - \u8df3\u8fc7\u51fa\u9519\u7684redlog\n     * DBMS_LOGMNR.NO_SQL_DELIMITER - \u4e0d\u4f7f\u7528 ';'\u5206\u5272redo sql\n     * DBMS_LOGMNR.NO_ROWID_IN_STMT - \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u7528\u4e8eUPDATE\u548cDELETE\u64cd\u4f5c\u7684SQL_REDO\u548cSQL_UNDO\u8bed\u53e5\u5728where\u5b50\u53e5\u4e2d\u5305\u542b\u201c ROWID =\u201d\u3002\n     *                                \u4f46\u662f\uff0c\u8fd9\u5bf9\u4e8e\u60f3\u8981\u91cd\u65b0\u6267\u884cSQL\u8bed\u53e5\u7684\u5e94\u7528\u7a0b\u5e8f\u662f\u4e0d\u65b9\u4fbf\u7684\u3002\u8bbe\u7f6e\u6b64\u9009\u9879\u540e\uff0c\u201c ROWID\u201d\u4e0d\u4f1a\u653e\u7f6e\u5728\u91cd\u6784\u8bed\u53e5\u7684\u672b\u5c3e\n     * DBMS_LOGMNR.DICT_FROM_ONLINE_CATALOG - \u4f7f\u7528\u5728\u7ebf\u5b57\u5178\n     * DBMS_LOGMNR.CONTINUOUS_MINE - \u9700\u8981\u5728\u751f\u6210\u91cd\u505a\u65e5\u5fd7\u7684\u540c\u4e00\u5b9e\u4f8b\u4e2d\u4f7f\u7528\u65e5\u5fd7\n     * DBMS_LOGMNR.COMMITTED_DATA_ONLY - \u6307\u5b9a\u6b64\u9009\u9879\u65f6\uff0cLogMiner\u5c06\u5c5e\u4e8e\u540c\u4e00\u4e8b\u52a1\u7684\u6240\u6709DML\u64cd\u4f5c\u5206\u7ec4\u5728\u4e00\u8d77\u3002\u4e8b\u52a1\u6309\u63d0\u4ea4\u987a\u5e8f\u8fd4\u56de\u3002\n     * DBMS_LOGMNR.STRING_LITERALS_IN_STMT - \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u683c\u5f0f\u5316\u683c\u5f0f\u5316\u7684SQL\u8bed\u53e5\u65f6\uff0cSQL_REDO\u548cSQL_UNDO\u8bed\u53e5\u4f1a\u4f7f\u7528\u6570\u636e\u5e93\u4f1a\u8bdd\u7684NLS\u8bbe\u7f6e\n     *                                       \u4f8b\u5982NLS_DATE_FORMAT\uff0cNLS_NUMERIC_CHARACTERS\u7b49\uff09\u3002\u4f7f\u7528\u6b64\u9009\u9879\uff0c\u5c06\u4f7f\u7528ANSI / ISO\u5b57\u7b26\u4e32\u6587\u5b57\u683c\u5f0f\u5bf9\u91cd\u6784\u7684SQL\u8bed\u53e5\u8fdb\u884c\u683c\u5f0f\u5316\u3002\n")),(0,a.kt)("p",null,"\u793a\u4f8b"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"EXECUTE DBMS_LOGMNR.START_LOGMNR( \n   STARTTIME => '01-Jan-2003 08:30:00', \n   ENDTIME => '01-Jan-2003 08:45:00', \n   OPTIONS => DBMS_LOGMNR.DICT_FROM_ONLINE_CATALOG + \n   DBMS_LOGMNR.CONTINUOUS_MINE);\n")),(0,a.kt)("h3",{id:"\u5728v-logmnr_contents\u4e2d\u67e5\u8be2\u611f\u5174\u8da3\u7684\u91cd\u505a\u6570\u636e"},"\u5728V$ LOGMNR_CONTENTS\u4e2d\u67e5\u8be2\u611f\u5174\u8da3\u7684\u91cd\u505a\u6570\u636e"),(0,a.kt)("p",null,"Logminer\u4f1a\u89e3\u6790redoLog\u91cc\u7684\u65e5\u5fd7\u52a0\u8f7d\u5230 v$LOGMNR_CONTENTS \u89c6\u56fe\u91cc\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4f7f\u7528 sql\u67e5\u8be2 \u5373\u53ef\u83b7\u53d6\u5bf9\u5e94\u6570\u636e\nv$LOGMNR_CONTENTS\u89c6\u56fe\u76f8\u5173\u5b57\u6bb5\n",(0,a.kt)("a",{parentName:"p",href:"https://docs.oracle.com/cd/B19306_01/server.102/b14237/dynviews_1154.htm"},"https://docs.oracle.com/cd/B19306_01/server.102/b14237/dynviews_1154.htm")),(0,a.kt)("p",null,"\u4e3b\u8981\u5b57\u6bb5\u6709\uff1a"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u5217"),(0,a.kt)("th",{parentName:"tr",align:null},"\u6570\u636e\u7c7b\u578b"),(0,a.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"SCN"),(0,a.kt)("td",{parentName:"tr",align:null},"NUMBER"),(0,a.kt)("td",{parentName:"tr",align:null},"oracle\u4e3a\u6bcf\u4e2a\u5df2\u63d0\u4ea4\u7684\u4e8b\u52a1\u5206\u914d\u552f\u4e00\u7684scn")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"OPERATION"),(0,a.kt)("td",{parentName:"tr",align:null},"VARCHAR2(32)"),(0,a.kt)("td",{parentName:"tr",align:null},"INSERT UPDATE DELETE DDL COMMIT ROLLBACK.....")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"SEG_OWNER"),(0,a.kt)("td",{parentName:"tr",align:null},"VARCHAR2(32)"),(0,a.kt)("td",{parentName:"tr",align:null},"schema")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"TABLE_NAME"),(0,a.kt)("td",{parentName:"tr",align:null},"VARCHAR2(32)"),(0,a.kt)("td",{parentName:"tr",align:null},"\u8868\u540d")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"TIMESTAMP"),(0,a.kt)("td",{parentName:"tr",align:null},"DATE"),(0,a.kt)("td",{parentName:"tr",align:null},"\u6570\u636e\u5e93\u53d8\u52a8\u65f6\u95f4\u6233")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"SQL_REDO"),(0,a.kt)("td",{parentName:"tr",align:null},"VARCHAR2(4000)"),(0,a.kt)("td",{parentName:"tr",align:null},"\u91cd\u5efa\u7684SQL\u8bed\u53e5\uff0c\u8be5\u8bed\u53e5\u7b49\u6548\u4e8e\u8fdb\u884c\u66f4\u6539\u7684\u539f\u59cbSQL\u8bed\u53e5")))),(0,a.kt)("p",null,"\u793a\u4f8b"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    scn,\n    timestamp,\n    operation,\n    seg_owner,\n    table_name,\n    sql_redo,\n    row_id,\n    csf\nFROM\n    v$logmnr_contents\nWHERE\n    scn > ?\n")),(0,a.kt)("p",null,"\u67e5\u8be2\u51fa\u6765\u7684\u6570\u636e\u793a\u4f8b\uff1a"),(0,a.kt)("div",{align:"center"},(0,a.kt)("img",{src:"../../images/LogMiner/LogMiner23.png"})),(0,a.kt)("h1",{id:"flinkx\u5982\u4f55\u4f7f\u7528logminer"},"Flinkx\u5982\u4f55\u4f7f\u7528Logminer"),(0,a.kt)("p",null,"\u4f7f\u7528Logminer\u5728\u4e8e\u5173\u952e2\u6b65\u9aa4\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u627e\u5230\u9700\u8981\u5206\u6790\u7684Redolog\u65e5\u5fd7\uff0c\u52a0\u8f7d\u5230Logminer"),(0,a.kt)("li",{parentName:"ul"},"\u5f00\u542fLogminer,\u5728  v$LOGMNR_CONTENTS \u67e5\u8be2\u611f\u5174\u8da3\u6570\u636e")),(0,a.kt)("h3",{id:"1-\u67e5\u627eredolog\u6587\u4ef6"},"1. \u67e5\u627eRedoLog\u6587\u4ef6"),(0,a.kt)("p",null,"\u4ece\u4e0a\u9762\u4ecb\u7ecd\u4e2d \u6211\u4eec\u53ef\u4ee5\u77e5\u9053 Redolog\u6765\u6e90\u4e8e\u65e5\u5fd7\u7ec4\u548c\u5f52\u6863\u65e5\u5fd7\u91cc\uff0c\u6240\u4ee5flinkx \u6839\u636eSCN\u53f7\u67e5\u8be2\u65e5\u5fd7\u7ec4\u4ee5\u53ca\u5f52\u6863\u65e5\u5fd7\u83b7\u53d6\u5230\u5bf9\u5e94\u7684\u6587\u4ef6"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    MIN(name) name,\n    first_change#\nFROM\n    (\n        SELECT\n            MIN(member) AS name,\n            first_change#,\n            281474976710655 AS next_change#\n        FROM\n            v$log       l\n            INNER JOIN v$logfile   f ON l.group# = f.group#\n        WHERE l.STATUS = 'CURRENT' OR l.STATUS = 'ACTIVE'\n        GROUP BY\n            first_change#\n        UNION\n        SELECT\n            name,\n            first_change#,\n            next_change#\n        FROM\n            v$archived_log\n        WHERE\n            name IS NOT NULL\n    )\nWHERE\n    first_change# >= ?\n    OR ? < next_change#\nGROUP BY\n    first_change#\nORDER BY\n    first_change#\n")),(0,a.kt)("p",null,"\u67e5\u8be2\u51fa\u6765\u7684\u6570\u636e\u793a\u4f8b\uff1a"),(0,a.kt)("div",{align:"center"},(0,a.kt)("img",{src:"../../images/LogMiner/LogMiner21.png"})),"\u6ce8\u610f\uff1a \u5982\u679cLogminer\u7684\u5904\u7406\u901f\u5ea6\u6bd4Oracle\u4ea7\u751f\u6570\u636e\u901f\u5ea6\u5feb\uff0c\u90a3\u4e48\u7406\u8bba\u4e0aFlinkx\u53ea\u9700\u8981\u52a0\u8f7d\u65e5\u5fd7\u7ec4\u6587\u4ef6\u4e0d\u9700\u8981\u52a0\u8f7d\u5f52\u6863\u65e5\u5fd7\u6587\u4ef6\uff0c\u800cLogminer\u52a0\u8f7d\u6587\u4ef6\u4f1a\u6bd4\u8f83\u6d88\u8017\u8d44\u6e90\uff0c\u6240\u4ee5\u4f1a\u5148\u8fdb\u884cRedoLog\u6587\u4ef6\u7684\u67e5\u627e\uff0c\u5982\u679c\u672c\u6b21\u67e5\u627e\u7684\u6587\u4ef6\u548c\u4e0a\u6b21\u7684\u6ca1\u6709\u533a\u522b\uff0c\u8bf4\u660eLogminer\u4e0d\u9700\u8981\u52a0\u8f7d\u65b0\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u53ea\u9700\u8981\u91cd\u65b0\u518d\u4ece\u89c6\u56fe\u91cc\u67e5\u8be2\u6570\u636e\u5373\u53ef",(0,a.kt)("h3",{id:"2-\u52a0\u8f7d\u6587\u4ef6\u5230logminer"},"2. \u52a0\u8f7d\u6587\u4ef6\u5230Logminer"),(0,a.kt)("p",null,"\u901a\u8fc7\u4e00\u4e2a\u5b58\u50a8\u8fc7\u7a0b \u67e5\u8be2\u5230\u65e5\u5fd7\u6587\u4ef6\u4e4b\u540e \u52a0\u8f7d\u5230Logminer\u91cc \u5e76\u5f00\u542fLogminer"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"DECLARE\n    st          BOOLEAN := true;\n    start_scn   NUMBER := ?;\nBEGIN\n    FOR l_log_rec IN (\n        SELECT\n            MIN(name) name,\n            first_change#\n        FROM\n            (\n                SELECT\n                    MIN(member) AS name,\n                    first_change#,\n                    281474976710655 AS next_change#\n                FROM\n                    v$log       l\n                    INNER JOIN v$logfile   f ON l.group# = f.group#\n                WHERE l.STATUS = 'CURRENT' OR l.STATUS = 'ACTIVE'\n                GROUP BY\n                    first_change#\n                UNION\n                SELECT\n                    name,\n                    first_change#,\n                    next_change#\n                FROM\n                    v$archived_log\n                WHERE\n                    name IS NOT NULL\n            )\n        WHERE\n            first_change# >= start_scn\n            OR start_scn < next_change#\n        GROUP BY\n            first_change#\n        ORDER BY\n            first_change#\n    ) LOOP IF st THEN\n        SYS.DBMS_LOGMNR.add_logfile(l_log_rec.name, SYS.DBMS_LOGMNR.new);\n        st := false;\n    ELSE\n        SYS.DBMS_LOGMNR.add_logfile(l_log_rec.name);\n    END IF;\n    END LOOP;\n\n    SYS.DBMS_LOGMNR.start_logmnr(       options =>          SYS.DBMS_LOGMNR.skip_corruption        + SYS.DBMS_LOGMNR.no_sql_delimiter        + SYS.DBMS_LOGMNR.no_rowid_in_stmt\n       + SYS.DBMS_LOGMNR.dict_from_online_catalog        + SYS.DBMS_LOGMNR.string_literals_in_stmt   );\nEND;\n")),(0,a.kt)("h3",{id:"3-\u67e5\u8be2\u6570\u636e"},"3. \u67e5\u8be2\u6570\u636e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    scn,\n    timestamp,\n    operation,\n    seg_owner,\n    table_name,\n    sql_redo,\n    row_id,\n    csf\nFROM\n    v$logmnr_contents\nWHERE\n    scn > ?\n")),(0,a.kt)("p",null,"Flinkx\u5c31\u662f\u5728\u4e00\u4e2a\u5faa\u73af\u91cc \u6267\u884c\u4e0a\u8ff0sql\u8bed\u53e5\u67e5\u8be2\u6570\u636e\u3002 \u67e5\u8be2\u65e5\u5fd7\u6587\u4ef6\uff0c\u52a0\u8f7d\u5230logminer\uff0c\u5f00\u542flogminer\uff0c\u8bfb\u53d6\u6570\u636e\uff0c\u66f4\u65b0\u5f53\u524d\u6700\u65b0SCN\u53f7\uff0c\u5f53\u6570\u636e\u8bfb\u53d6\u5b8c\u6bd5\uff0c\u4ee3\u8868\u672c\u6b21\u52a0\u8f7d\u7684\u65e5\u5fd7\u6587\u4ef6\u52a0\u8f7d\u5b8c\u4e86\uff0c\u901a\u8fc7SCN\u53f7\u5bfb\u627e\u540e\u7eed\u65e5\u5fd7\u6587\u4ef6\uff0c\u91cd\u590d\u4e0a\u8ff0\u64cd\u4f5c"),(0,a.kt)("div",{align:"center"},(0,a.kt)("img",{src:"../../images/LogMiner/LogMiner22.png"})),(0,a.kt)("p",null,"\u4ece\xa0v$logmnr_contents\u83b7\u53d6\u5230\u6570\u636e\u4e4b\u540e\uff0cFlinkx \u4f7f\u7528 net.sf.jsqlparser.parser.CCJSqlParserUtil \u6765\u89e3\u6790 sql_redo \u503c\n\u83b7\u53d6\u5230\u7684sql_redo\u8bed\u53e5\u683c\u5f0f\u793a\u4f8b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'insert into "TUDOU"."CDC"("ID","USER_ID","NAME","date1") values (\'19\',\'1\',\'b\',TO_DATE(\'2021-01-29 11:25:50\', \'YYYY-MM-DD HH24:MI:SS\'))\n')),(0,a.kt)("p",null,"\u4f7f\u7528net.sf.jsqlparser.parser.CCJSqlParserUtil \u89e3\u6790\u4e0a\u8ff0SQL\u83b7\u53d6\u5404\u4e2a\u5b57\u6bb5\u7684\u503c"),(0,a.kt)("h3",{id:"oracle10-\u548coracle11\u7684\u90e8\u5206\u533a\u522b"},"Oracle10 \u548cOracle11\u7684\u90e8\u5206\u533a\u522b"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"v$LOGMNR_CONTENTS \u91ccOracle10 \u6bd4 Oracle11 \u5c11\u4e86 commit_scn\u5b57\u6bb5"),(0,a.kt)("li",{parentName:"ol"},"\u65e5\u5fd7\u7ec4\u5b57\u6bb5\u91cc\u6ca1\u6709next_change#\u5b57\u6bb5"),(0,a.kt)("li",{parentName:"ol"},"\u5982\u679cSql\u91cc\u542b\u6709ToDate\u51fd\u6570\uff0cLogminer10\u7684sql_redo\u52a0\u8f7d\u7684\u662fToDate\u51fd\u6570\u65e5\u671f\u683c\u5f0f\u9ed8\u8ba4\u662fDD-MON-RR\u683c\u5f0f\uff0c\u800cLogminer11\u5219\u662fTodate\u51fd\u6570\u6267\u884c\u540e\u7684\u503c\uff0c\u6240\u4ee5Logminer10\u4f1a\u5728\u83b7\u53d6\u8fde\u63a5\u7684\u65f6\u5019\uff0c\u6267\u884c\u4e0b\u5217SQL,\u8bbe\u7f6e\u65e5\u671f\u683c\u5f0f\uff0cFLinkx\u518d\u5bf9\u5176\u8fdb\u884c\u6b63\u5219\u5339\u914d\uff0c\u66ff\u6362\u5f97\u5230\u6700\u7ec8\u7684\u503c\u3002")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"    //\u4fee\u6539\u5f53\u524d\u4f1a\u8bdd\u7684date\u65e5\u671f\u683c\u5f0f\n   public final static String SQL_ALTER_DATE_FORMAT =\"ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD HH24:MI:SS'\";\n\n    //\u4fee\u6539\u5f53\u524d\u4f1a\u8bdd\u7684timestamp\u65e5\u671f\u683c\u5f0f\n    public final static String NLS_TIMESTAMP_FORMAT =\"ALTER SESSION SET NLS_TIMESTAMP_FORMAT = 'YYYY-MM-DD HH24:MI:SS.FF6'\";\n\n")))}N.isMDXComponent=!0}}]);